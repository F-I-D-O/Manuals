<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>Powershell Manual - Manuals</title>
        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css">
        <link href="../../extra.css" rel="stylesheet">

        <script src="../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../..">Manuals</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Programming <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">C++</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../Programming/C%2B%2B/C%2B%2B%20Debugging%20and%20Profiling/" class="dropdown-item">C++ Debugging and Profiling</a>
</li>
            
<li>
    <a href="../../Programming/C%2B%2B/C%2B%2B%20Manual/" class="dropdown-item">C++ Manual</a>
</li>
            
<li>
    <a href="../../Programming/C%2B%2B/C%2B%2B%20Workflow/" class="dropdown-item">C++ Workflow</a>
</li>
            
<li>
    <a href="../../Programming/C%2B%2B/CMake%20Manual/" class="dropdown-item">CMake Manual</a>
</li>
            
<li>
    <a href="../../Programming/C%2B%2B/Google%20Test/" class="dropdown-item">Google Test</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Java</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../Programming/Java/Debugging%20Java/" class="dropdown-item">Debugging Java</a>
</li>
            
<li>
    <a href="../../Programming/Java/Jackson/" class="dropdown-item">Jackson</a>
</li>
            
<li>
    <a href="../../Programming/Java/Java%20Manual/" class="dropdown-item">Java Manual</a>
</li>
            
<li>
    <a href="../../Programming/Java/Java%20Workflow/" class="dropdown-item">Java Workflow</a>
</li>
            
<li>
    <a href="../../Programming/Java/Maven/" class="dropdown-item">Maven</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Python</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../Programming/Python/Matplotlib%20Manual/" class="dropdown-item">Matplotlib Manual</a>
</li>
            
<li>
    <a href="../../Programming/Python/Pandas%20Manual/" class="dropdown-item">Pandas Manual</a>
</li>
            
<li>
    <a href="../../Programming/Python/Plotly%20Manual/" class="dropdown-item">Plotly Manual</a>
</li>
            
<li>
    <a href="../../Programming/Python/Python%20Debugging/" class="dropdown-item">Python Debugging</a>
</li>
            
<li>
    <a href="../../Programming/Python/Python%20Manual/" class="dropdown-item">Python Manual</a>
</li>
            
<li>
    <a href="../../Programming/Python/Python%20Workflow/" class="dropdown-item">Python Workflow</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Web</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../Programming/Web/CSS%20Manual/" class="dropdown-item">CSS Manual</a>
</li>
            
<li>
    <a href="../../Programming/Web/css/" class="dropdown-item">css</a>
</li>
            
<li>
    <a href="../../Programming/Web/Google%20API%20and%20Apps%20Script/" class="dropdown-item">Google API and Apps Script</a>
</li>
            
<li>
    <a href="../../Programming/Web/htaccess/" class="dropdown-item">htaccess</a>
</li>
            
<li>
    <a href="../../Programming/Web/JavaScript/" class="dropdown-item">JavaScript</a>
</li>
            
<li>
    <a href="../../Programming/Web/Jekyll/" class="dropdown-item">Jekyll</a>
</li>
            
<li>
    <a href="../../Programming/Web/mkdocs/" class="dropdown-item">mkdocs</a>
</li>
    </ul>
  </li>
                                    
<li>
    <a href="../../Programming/Common/" class="dropdown-item">Common</a>
</li>
                                    
<li>
    <a href="../../Programming/Git/" class="dropdown-item">Git</a>
</li>
                                    
<li>
    <a href="../../Programming/Gurobi/" class="dropdown-item">Gurobi</a>
</li>
                                    
<li>
    <a href="../../Programming/HDF/" class="dropdown-item">HDF</a>
</li>
                                    
<li>
    <a href="../../Programming/JSON/" class="dropdown-item">JSON</a>
</li>
                                    
<li>
    <a href="../../Programming/Native%20Libraries/" class="dropdown-item">Native Libraries</a>
</li>
                                    
<li>
    <a href="../../Programming/PostgreSQL%20Manual/" class="dropdown-item">PostgreSQL Manual</a>
</li>
                                    
<li>
    <a href="../../Programming/Regex/" class="dropdown-item">Regex</a>
</li>
                                    
<li>
    <a href="../../Programming/Ruby%20Workflow/" class="dropdown-item">Ruby Workflow</a>
</li>
                                    
<li>
    <a href="../../Programming/SQL%20Manual/" class="dropdown-item">SQL Manual</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">LaTeX <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../LaTeX/Latex%20manual/" class="dropdown-item">Latex manual</a>
</li>
                                    
<li>
    <a href="../../LaTeX/LaTeX%20workflow/" class="dropdown-item">LaTeX workflow</a>
</li>
                                </ul>
                            </li>
                            <li class="navitem">
                                <a href="../../Ubuntu" class="nav-link">Ubuntu</a>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Windows <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../Excel%20Manual/" class="dropdown-item">Excel Manual</a>
</li>
                                    
<li>
    <a href="../PowerPoint/" class="dropdown-item">PowerPoint</a>
</li>
                                    
<li>
    <a href="./" class="dropdown-item active">Powershell Manual</a>
</li>
                                    
<li>
    <a href="../VSCode/" class="dropdown-item">VSCode</a>
</li>
                                    
<li>
    <a href="../Windows%20Manual/" class="dropdown-item">Windows Manual</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Audio & Video <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../Audio%20%26%20Video/FFMpeg/" class="dropdown-item">FFMpeg</a>
</li>
                                    
<li>
    <a href="../../Audio%20%26%20Video/VLC/" class="dropdown-item">VLC</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Cloud computing <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../Cloud%20computing/Lmod/" class="dropdown-item">Lmod</a>
</li>
                                    
<li>
    <a href="../../Cloud%20computing/RCI%20cluster/" class="dropdown-item">RCI cluster</a>
</li>
                                    
<li>
    <a href="../../Cloud%20computing/Slurm/" class="dropdown-item">Slurm</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">GIS <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../GIS/GIS%20formats/" class="dropdown-item">GIS formats</a>
</li>
                                    
<li>
    <a href="../../GIS/Overpass%20Manual/" class="dropdown-item">Overpass Manual</a>
</li>
                                    
<li>
    <a href="../../GIS/QGIS/" class="dropdown-item">QGIS</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Images <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../Images/Midjourney/" class="dropdown-item">Midjourney</a>
</li>
                                    
<li>
    <a href="../../Images/Photopea/" class="dropdown-item">Photopea</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Linux <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../Linux/Linux%20Manual/" class="dropdown-item">Linux Manual</a>
</li>
                                </ul>
                            </li>
                            <li class="navitem">
                                <a href="../../Arxiv/" class="nav-link">Arxiv</a>
                            </li>
                            <li class="navitem">
                                <a href="../.." class="nav-link">index</a>
                            </li>
                            <li class="navitem">
                                <a href="../../Markdown/" class="nav-link">Markdown</a>
                            </li>
                            <li class="navitem">
                                <a href="../../Network/" class="nav-link">Network</a>
                            </li>
                            <li class="navitem">
                                <a href="../../Security/" class="nav-link">Security</a>
                            </li>
                            <li class="navitem">
                                <a href="../../vscode/" class="nav-link">vscode</a>
                            </li>
                            <li class="navitem">
                                <a href="../../Web%20Tricks/" class="nav-link">Web Tricks</a>
                            </li>
                            <li class="navitem">
                                <a href="../../YAML/" class="nav-link">YAML</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../PowerPoint/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../VSCode/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#introduction" class="nav-link">Introduction</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#new-powershell" class="nav-link">New PowerShell</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#quick-edit-insert-mode" class="nav-link">Quick Edit / Insert Mode</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#script-blocks" class="nav-link">Script Blocks</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#parameter-blocks" class="nav-link">Parameter blocks</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#quoting" class="nav-link">Quoting</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#arguments-starting-with-and-containing" class="nav-link">Arguments starting with - and containing .</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#escaping-and-in-arguments" class="nav-link">Escaping " and ' in Arguments</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#command-execution" class="nav-link">Command execution</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#print-the-exit-code" class="nav-link">Print the exit code</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#no-output-for-exe-file" class="nav-link">No Output for EXE file</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#variables" class="nav-link">Variables</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#environment-variables" class="nav-link">Environment variables</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#operations-on-variables" class="nav-link">Operations on Variables</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="3"><a href="#string-operations" class="nav-link">String Operations</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#operators" class="nav-link">Operators</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#comparison-and-string-operators" class="nav-link">Comparison and String Operators</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#logical-operators" class="nav-link">Logical Operators</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#control-structures" class="nav-link">Control Structures</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#conditions" class="nav-link">Conditions</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="3"><a href="#if" class="nav-link">if</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#loops" class="nav-link">Loops</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="3"><a href="#foreach" class="nav-link">foreach</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#inputs-and-outputs" class="nav-link">Inputs and Outputs</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#inputs" class="nav-link">Inputs</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#outputs" class="nav-link">Outputs</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#pipes-and-redirection" class="nav-link">Pipes and Redirection</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#string-manipulation" class="nav-link">String Manipulation</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#replace" class="nav-link">Replace</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#match" class="nav-link">Match</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#select-string" class="nav-link">Select-String</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#selecting-the-matched-string" class="nav-link">Selecting the matched string</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#select-object" class="nav-link">Select-Object</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#arrays" class="nav-link">Arrays</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#network" class="nav-link">Network</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#netstat" class="nav-link">netstat</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="3"><a href="#lot-of-kubernetes-entries-in-the-log" class="nav-link">Lot of kubernetes entries in the log</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#display-executable-for-connection" class="nav-link">Display executable for connection</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#system-information" class="nav-link">System Information</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#cim-and-wmi" class="nav-link">CIM and WMI</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#windows-registry" class="nav-link">Windows Registry</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#advanced-script-blocks" class="nav-link">Advanced Script blocks</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#elevation" class="nav-link">Elevation</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#powershell-history" class="nav-link">PowerShell History</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#usefull-commands" class="nav-link">Usefull Commands</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#file-encoding-conversion" class="nav-link">File Encoding Conversion</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#delete-all-files-with-a-certain-extension" class="nav-link">Delete all files with a certain extension</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#batch-rename" class="nav-link">Batch rename</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#count-lines-in-large-file" class="nav-link">Count Lines in large file</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#get-help" class="nav-link">Get Help</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#translate-alias-to-command" class="nav-link">Translate alias to command</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#get-the-path-of-the-current-script" class="nav-link">Get the path of the current script</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#compute-the-hash-of-a-file" class="nav-link">Compute the hash of a file</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h1>
<p>PowerShell is the new command line interface for Windows that replaces the old command prompt. It is superior in almost every aspect so it is recommended to use it instead of the old command prompt. </p>
<p>The PowerShell script files have the <code>.ps1</code> extension. </p>
<p>In addition to system commands, PowerShell can also execute native PowerShell commands called <a href="https://learn.microsoft.com/en-us/powershell/scripting/powershell-commands">cmdlets</a>.</p>
<h2 id="new-powershell">New PowerShell<a class="headerlink" href="#new-powershell" title="Permanent link">&para;</a></h2>
<p>The PowerShell Integrated in Windows is version 5. You can recognize it by the iconical blue background color. This old version has some important limitations (e. g. <a href="https://stackoverflow.com/questions/6714165/powershell-stripping-double-quotes-from-command-line-arguments">it cannot pass arguments containing arguments with spaces</a>).</p>
<p>Therefore, it is best to install the <a href="https://github.com/PowerShell/PowerShell">new PowerShell</a> first.</p>
<h2 id="quick-edit-insert-mode">Quick Edit / Insert Mode<a class="headerlink" href="#quick-edit-insert-mode" title="Permanent link">&para;</a></h2>
<p>PowerShell enables copy/pase of commands. The downside is that every time you click inside PowerShell, the execution (if PowerShell is currently executing somethig) stops. To resume the execution, hit <code>enter</code>.</p>
<h2 id="script-blocks">Script Blocks<a class="headerlink" href="#script-blocks" title="Permanent link">&para;</a></h2>
<p><a href="https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_script_blocks">documentation</a></p>
<p>A basic unit of execution in PowerShell is a script block. A script block can be:</p>
<ul>
<li>a piece of code enclosed in curly braces <code>{}</code>.</li>
<li>a function </li>
<li>a script</li>
</ul>
<p>A script block can have parameters. The parameters are defined using the <code>param</code> keyword. Example:</p>
<pre><code class="language-PowerShell">$myFunction = {
    param($param1, $param2)
    # do something
}

# or in a function
function MyFunction {
    param($param1, $param2)
    # do something
}

# or in a script
param($param1, $param2)
</code></pre>
<h2 id="parameter-blocks">Parameter blocks<a class="headerlink" href="#parameter-blocks" title="Permanent link">&para;</a></h2>
<p>The parameter block defines the parameters of the script block. By default (<code>param()</code>), only the build in parameters are available. In the parameter block, individual parameters are divided by commas. Example:</p>
<pre><code class="language-PowerShell">$myFunction = {
    param($param1, $param2)
    # do something
}
</code></pre>
<p>Parameters can be typed. Example:</p>
<pre><code class="language-PowerShell">$myFunction = {
    param([int]$param1, [string]$param2, [switch]$param3)
    # do something
}
</code></pre>
<p>Parameters can be mandatory. Example:</p>
<pre><code class="language-PowerShell">$myFunction = {
    param(
        [Parameter(Mandatory)][int]$param1, 
        [Parameter(Mandatory)][string]$param2, 
        [switch]$param3
    )
    # do something
}
</code></pre>
<p>We can also validate the parameters. Example:</p>
<pre><code class="language-PowerShell">$myFunction = {
    param(
        [Parameter(Mandatory)][ValidateRange(0, 100)][int]$param1, 
        [Parameter(Mandatory)][ValidateSet(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;)][string]$param2, 
        [Parameter(Mandatory)][ValidateScript({$_ -eq &quot;a&quot; -or $_ -eq &quot;b&quot;})][string]$param3
    )
    # do something
}
</code></pre>
<p>Also with custom error message:</p>
<pre><code class="language-PowerShell">$myFunction = {
    param(
        [Parameter(Mandatory)][ValidateScript({ Test-Path $_ }, ErrorMessage=&quot;Path does not exists: {0}&quot;)][string]$path
    )
    # do something
}
</code></pre>
<p>The advanced usage of parameters is described in the <a href="https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_functions_advanced_parameters">documentation</a>.</p>
<h1 id="quoting">Quoting<a class="headerlink" href="#quoting" title="Permanent link">&para;</a></h1>
<p><a href="https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_quoting_rules">documentation</a></p>
<p>In PowerShell, there are two types of quoting:</p>
<ul>
<li><code>"</code> (double quotes): for expandable strings. These strings can contain variables and expressions that are evaluated.<ul>
<li>non-basic variables need to be wrapped by expression <code>$()</code>, e.g. <code>$($PSVersionTable.PSVersion)</code></li>
<li>To separate the variable from the following text, use <code>${}</code>. Example: <code>${myVar}Text</code></li>
<li>to escape (not evaluate) the <code>$</code> sign, use the backtick: <code>echo "`$myVar"</code> prints <code>$myVar</code></li>
</ul>
</li>
<li><code>'</code> (single quotes): for literal strings. These strings are not evaluated.</li>
</ul>
<h2 id="arguments-starting-with-and-containing">Arguments starting with <code>-</code> and containing <code>.</code><a class="headerlink" href="#arguments-starting-with-and-containing" title="Permanent link">&para;</a></h2>
<p>If a program argument starts with <code>-</code>, <strong>and</strong> contains <code>.</code> it needs to be wrapped by <code>'</code>. Otherwise, the argument will be split on the dot. Example:</p>
<pre><code>mvn exec:java -Dexec.mainClass=com.example.MyExample -Dfile.encoding=UTF-8
</code></pre>
<p>In Powershell, this needs to be converted to:</p>
<pre><code class="language-PowerShell">mvn exec:java '-Dexec.mainClass=com.example.MyExample' '-Dfile.encoding=UTF-8'
</code></pre>
<p>The problem may arise if the argument or its part needs to be quotted as well. Then:</p>
<ul>
<li>for first level of quoting, use <code>"</code> (double quotes)</li>
<li>for second level of quoting, use <code>''</code> (two single quotes)
Example:</li>
</ul>
<pre><code class="language-PowerShell">mvn exec:exec '-Dexec.executable=&quot;java&quot;' '-Dexec.args=&quot;-Xmx30g -Djava.library.path=''C:\Program Files\HDF_Group\HDF5\1.14.3\bin'' -classpath %classpath cz.cvut.fel.aic.simod.OnDemandVehiclesSimulation&quot;'
</code></pre>
<h2 id="escaping-and-in-arguments">Escaping <code>"</code> and <code>'</code> in Arguments<a class="headerlink" href="#escaping-and-in-arguments" title="Permanent link">&para;</a></h2>
<p>Double quotes <code>"</code> contained in arguments can be preserved by escaping with backslash: <code>\"</code>. Example for that can be passing an argument list to some executable:</p>
<pre><code>'args=\&quot;arg1 arg2\&quot;'
</code></pre>
<p>Single quotes <code>'</code> are esceped by duble single quote: <code>''</code>. Example can be passing a list of args, where some of them contains space:</p>
<pre><code>'args=\&quot;''arg1 with space'' arg2\&quot;'
</code></pre>
<h1 id="command-execution">Command execution<a class="headerlink" href="#command-execution" title="Permanent link">&para;</a></h1>
<p>Normal commands are executed by just typing them. However, if the command contains a space, wrapping it in quotes does not work. In this case, the <code>&amp;</code> operator has to be used. Example:</p>
<pre><code class="language-PowerShell">&amp; &quot;C:\Program Files\Java\jdk1.8.0_181\bin\java.exe&quot; -version
</code></pre>
<h2 id="print-the-exit-code">Print the exit code<a class="headerlink" href="#print-the-exit-code" title="Permanent link">&para;</a></h2>
<p>To print the exit code of the last command, there are two options:</p>
<ul>
<li><code>$?</code>: returns <code>True</code> if the last command was successful, <code>False</code> otherwise</li>
<li><code>$LastExitCode</code> variable contains the exit code of the last command</li>
</ul>
<h2 id="no-output-for-exe-file">No Output for EXE file<a class="headerlink" href="#no-output-for-exe-file" title="Permanent link">&para;</a></h2>
<p>Some errors are unfortunatelly not reported by powershell (e.g. <a href="https://stackoverflow.com/questions/23012332/how-to-make-powershell-tell-me-about-missing-dlls">missing dll</a>). The solution is to run such program in cmd, which reports the error.</p>
<h1 id="variables">Variables<a class="headerlink" href="#variables" title="Permanent link">&para;</a></h1>
<p>Variables are defined by the <code>$</code> sign. Example:</p>
<pre><code class="language-PowerShell">$myVar = &quot;Hello, World!&quot;
</code></pre>
<p>To print the variable, just type its name. Example:</p>
<pre><code class="language-PowerShell">$myVar
</code></pre>
<h2 id="environment-variables">Environment variables<a class="headerlink" href="#environment-variables" title="Permanent link">&para;</a></h2>
<p>They are accessed by the <code>$env:</code> prefix. Example:</p>
<pre><code class="language-PowerShell">$env:PATH
</code></pre>
<h2 id="operations-on-variables">Operations on Variables<a class="headerlink" href="#operations-on-variables" title="Permanent link">&para;</a></h2>
<p>The variables can be used in expressions. Example:</p>
<pre><code class="language-PowerShell">$myVar = 5
$myVar + 3
</code></pre>
<h3 id="string-operations">String Operations<a class="headerlink" href="#string-operations" title="Permanent link">&para;</a></h3>
<p>Strings can be concatenated using the <code>+</code> operator. Examples:</p>
<pre><code class="language-PowerShell">$myVar = &quot;Hello, &quot; + &quot;World!&quot;

# append to a path:
$env:PATH += &quot;;C:\Program Files\Java\jdk1.8.0_181\bin&quot;

# prepend to a path:
$env:PATH = &quot;C:\Program Files\Java\jdk1.8.0_181\bin;&quot; + $env:PATH
</code></pre>
<h1 id="operators">Operators<a class="headerlink" href="#operators" title="Permanent link">&para;</a></h1>
<h2 id="comparison-and-string-operators">Comparison and String Operators<a class="headerlink" href="#comparison-and-string-operators" title="Permanent link">&para;</a></h2>
<p><a href="https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_comparison_operators">documentation</a></p>
<p>Equality operators:</p>
<ul>
<li><code>-eq</code>: equal</li>
<li><code>-ne</code>: not equal</li>
<li><code>-gt</code>: greater than</li>
<li><code>-lt</code>: less than</li>
<li><code>-ge</code>: greater or equal</li>
<li><code>-le</code>: less or equal</li>
</ul>
<p>Matching operators:</p>
<ul>
<li><code>-match</code>: match</li>
</ul>
<h2 id="logical-operators">Logical Operators<a class="headerlink" href="#logical-operators" title="Permanent link">&para;</a></h2>
<p><a href="https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_logical_operators">documentation</a></p>
<ul>
<li><code>-and</code>: logical and</li>
<li><code>-or</code>: logical or</li>
<li><code>-not</code>: logical not</li>
</ul>
<h1 id="control-structures">Control Structures<a class="headerlink" href="#control-structures" title="Permanent link">&para;</a></h1>
<h2 id="conditions">Conditions<a class="headerlink" href="#conditions" title="Permanent link">&para;</a></h2>
<h3 id="if"><code>if</code><a class="headerlink" href="#if" title="Permanent link">&para;</a></h3>
<p>The <code>if</code> statement is used for conditional execution. The syntax is:</p>
<pre><code class="language-PowerShell">if ($condition) {
    # do something
}
elseif ($anotherCondition) {
    # do something else
}
else {
    # do something else
}
</code></pre>
<p>The <code>if</code> structure is also available as a cmdlet <code>If</code>. Example:</p>
<pre><code class="language-PowerShell">If ($condition) { &quot;True&quot; } Else { &quot;False&quot; }
</code></pre>
<p>The <code>If</code> cmdlet is also available as an alias <code>if</code> and <code>?</code>.</p>
<h2 id="loops">Loops<a class="headerlink" href="#loops" title="Permanent link">&para;</a></h2>
<h3 id="foreach"><code>foreach</code><a class="headerlink" href="#foreach" title="Permanent link">&para;</a></h3>
<p>The <code>foreach</code> cycle iterates over a collection. The syntax is:</p>
<pre><code class="language-PowerShell">foreach ($item in $collection) {
    # do something with $item
}
</code></pre>
<p>The foreach structure is also available as a cmdlet <code>ForEach-Object</code>. In this case, we access the current item using the <code>$_</code> variable. Example:</p>
<pre><code class="language-PowerShell">Get-ChildItem | ForEach-Object { $_.Name }
</code></pre>
<p>The above command lists the names of all files in the current directory.</p>
<p>The alias for the <code>ForEach-Object</code> cmdlet is <code>foreach</code> and <code>%</code>.</p>
<h1 id="inputs-and-outputs">Inputs and Outputs<a class="headerlink" href="#inputs-and-outputs" title="Permanent link">&para;</a></h1>
<h2 id="inputs">Inputs<a class="headerlink" href="#inputs" title="Permanent link">&para;</a></h2>
<p>To read a file, use the <a href="https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.management/get-content"><code>Get-Content</code></a> cmdlet. Example:</p>
<pre><code class="language-PowerShell">Get-Content &quot;C:\Users\user\file.txt&quot;
</code></pre>
<h2 id="outputs">Outputs<a class="headerlink" href="#outputs" title="Permanent link">&para;</a></h2>
<p>There are many output streams in PowerShell. We can use:</p>
<ul>
<li><code>Write-Output</code>: for standard output</li>
<li><code>Write-Error</code>: for standard error</li>
<li><code>Write-Warning</code>: for warnings</li>
<li><code>Write-Verbose</code>: for verbose output</li>
<li><a href="https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/write-debug"><code>Write-Debug</code></a>: for debug output</li>
<li><code>Write-Information</code>: for information output</li>
<li><a href="https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/write-host"><code>Write-Host</code></a>: for writing directly to the console. No output stream is used.</li>
</ul>
<p>By default, only the standard and error output streams are displayed. To display the other streams, we have several options:</p>
<ul>
<li>manually set the <code>$VerbosePreference</code>, <code>$DebugPreference</code>, <code>$WarningPreference</code>, <code>$InformationPreference</code> variables to <code>Continue</code> (default is <code>SilentlyContinue</code>), or</li>
<li>make the function or script we are running an <em>Advanced Function or Script</em> and use the <code>-Verbose</code>, <code>-Debug</code>, <code>-WarningAction</code>, <code>-InformationAction</code> parameters</li>
</ul>
<h1 id="pipes-and-redirection">Pipes and Redirection<a class="headerlink" href="#pipes-and-redirection" title="Permanent link">&para;</a></h1>
<p><a href="https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_pipelines">pipe documentation</a></p>
<p><a href="https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_redirection">redirection documentation</a></p>
<p>Output forwading is done using <code>|</code> (pipe) operator, just like in Linux. For redirecting the output to a file, there are the following operators:</p>
<ul>
<li><code>&gt;</code>: redirect to file, overwrite if exists</li>
<li><code>&gt;&gt;</code>: redirect to file, append if exists</li>
<li><code>&gt;&amp;1</code>: redirect to standard output stream</li>
</ul>
<p>When using any of these operators, by default, the standard output stream is redirected. If we want to redirect the standard error stream, we have to prepend 2 to the operator. Example:</p>
<pre><code class="language-PowerShell">dir &gt; out.txt # redirect standard output stream to out.txt
dir 2&gt; err.txt # redirect standard error stream to err.txt
</code></pre>
<p>If we want both see the output and redirect it to a file, we can use the <code>Tee-Object</code> command which is the equivalent of the <code>tee</code> command from Linux</p>
<p>In new PowerShell, we have even more options:</p>
<ul>
<li><code>3&gt;</code>: redirect Warning stream</li>
<li><code>4&gt;</code>: redirect Verbose stream</li>
<li><code>5&gt;</code>: redirect Debug stream</li>
<li><code>6&gt;</code>: redirect Information stream</li>
<li><code>*&gt;</code>: redirect all streams</li>
</ul>
<h1 id="string-manipulation">String Manipulation<a class="headerlink" href="#string-manipulation" title="Permanent link">&para;</a></h1>
<h2 id="replace">Replace<a class="headerlink" href="#replace" title="Permanent link">&para;</a></h2>
<p>For replacing a substring in a string, we have two options:</p>
<ul>
<li><code>Replace</code> method</li>
<li><code>-replace</code> operator</li>
</ul>
<p>The <code>Replace</code> method replaces all occurences of a string with another string. The syntax is:</p>
<pre><code class="language-PowerShell">$myString.Replace(&quot;oldString&quot;, &quot;newString&quot;)
</code></pre>
<p>The <code>-replace</code> operator uses regular expressions for replacing. The syntax is:</p>
<pre><code class="language-PowerShell">$myString -replace &quot;pattern&quot;, &quot;newString&quot;
</code></pre>
<p>Multiple replacements can be done using chained <code>-replace</code> operators. Example:</p>
<pre><code class="language-PowerShell">$myString -replace &quot;pattern1&quot;, &quot;newString1&quot; -replace &quot;pattern2&quot;, &quot;newString2&quot;
</code></pre>
<h2 id="match">Match<a class="headerlink" href="#match" title="Permanent link">&para;</a></h2>
<p>To test if a string matches a regular expression, use the <code>Match</code> method. The syntax is:</p>
<pre><code class="language-PowerShell">$myString -match &quot;pattern&quot;
</code></pre>
<h1 id="select-string"><code>Select-String</code><a class="headerlink" href="#select-string" title="Permanent link">&para;</a></h1>
<p>The <a href="https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/select-string"><code>Select-String</code></a> is the <code>grep</code> equivalent for PowerShell. The alias for the comand is <code>sls</code>. Parameters:</p>
<ul>
<li><code>-Content &lt;before&gt;[, &lt;after&gt;]</code>: Select also <code>&lt;before&gt;</code> lines before the matched line and <code>&lt;after&gt;</code> lines after the matched line</li>
<li><code>-Pattern</code>: If we want to use a regular expression for searching, not a plain string</li>
</ul>
<h2 id="selecting-the-matched-string">Selecting the matched string<a class="headerlink" href="#selecting-the-matched-string" title="Permanent link">&para;</a></h2>
<p>If we use the <code>Select-String</code> with the <code>-Pattern</code> parameter, the matching lines are returned with the matching string highlighted. If we want to get only the matching string, we have to access the <code>Matches.Value</code> property for each line. Example:</p>
<pre><code class="language-PowerShell">Select-String -Pattern &quot;pattern&quot; | ForEach-Object { $_.Matches.Value }
</code></pre>
<h1 id="select-object"><code>Select-Object</code><a class="headerlink" href="#select-object" title="Permanent link">&para;</a></h1>
<p>The <a href="https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/select-object"><code>Select-Object</code></a> selects the specified properties of an object. Example:</p>
<pre><code class="language-PowerShell">Get-Process | Select-Object -Property Name, Id
</code></pre>
<h1 id="arrays">Arrays<a class="headerlink" href="#arrays" title="Permanent link">&para;</a></h1>
<p>To creante an array, use the <code>@()</code> operator: <code>a = @()</code> To add an element to an array, use the <code>+=</code> operator: <code>a += 1</code>. The arrays can be iterated over using the <code>foreach</code> loop.</p>
<h1 id="network">Network<a class="headerlink" href="#network" title="Permanent link">&para;</a></h1>
<h2 id="netstat"><a href="https://en.wikipedia.org/wiki/Netstat"><code>netstat</code></a><a class="headerlink" href="#netstat" title="Permanent link">&para;</a></h2>
<p>The <a href="https://en.wikipedia.org/wiki/Netstat"><code>netstat</code></a> is the basic network monitoring program. It displays TCP connections. It originated on Linux, so the usage and parameters are described in the Linux manual. Below, we discuss the differencies in the command interface and behavior of the Windows version of the command.</p>
<p><a href="https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/netstat">Winndows manual</a>.</p>
<h3 id="lot-of-kubernetes-entries-in-the-log">Lot of kubernetes entries in the log<a class="headerlink" href="#lot-of-kubernetes-entries-in-the-log" title="Permanent link">&para;</a></h3>
<p>By default, the netstat command translates IPs into names. Unfortunatelly, on Windows, it also uses the information from the hosts file (<code>C:\Windows\System32\drivers\etc\hosts</code>). This is a problem, because some services, like Docker, can use the <code>hosts</code> file to redirect some adddress to localhost. Therefore, at the end, all localhost entries are named kubernetes. Solution options:</p>
<ul>
<li>use the <code>-n</code> parameter for <code>netstat</code> or</li>
<li>remove the redirection to <code>localhost</code> in the <code>hosts</code> file </li>
</ul>
<h3 id="display-executable-for-connection">Display executable for connection<a class="headerlink" href="#display-executable-for-connection" title="Permanent link">&para;</a></h3>
<p>To display executable for all connection, just use the <code>-b</code> swith. For filtering out only some, you have to use the <code>-Context</code> parameter in the <code>Select-String</code> command, as the executable is printed one line below the connection: <code>netstat -b | sls &lt;search pattern&gt; -Context 0,1</code></p>
<h1 id="system-information">System Information<a class="headerlink" href="#system-information" title="Permanent link">&para;</a></h1>
<p><a href="https://learn.microsoft.com/en-us/powershell/module/cimcmdlets">CIM documentation</a></p>
<p><a href="https://learn.microsoft.com/en-us/windows/win32/wmisdk/wmi-classes">WMI classes</a></p>
<p>There are several interfaces for getting system information in PowerShell:</p>
<ul>
<li>Using the <a href="https://en.wikipedia.org/wiki/Common_Information_Model_(computing)"><em>Common Information Model</em> (CIM)</a></li>
<li>Using the <a href="https://en.wikipedia.org/wiki/Windows_Management_Instrumentation"><em><code>Windows Management Instrumentation</code> (WMI)</em></a> </li>
<li>By reading from the <a href="https://en.wikipedia.org/wiki/Windows_Registry"><em>registry</em></a></li>
</ul>
<h2 id="cim-and-wmi">CIM and WMI<a class="headerlink" href="#cim-and-wmi" title="Permanent link">&para;</a></h2>
<p>Because the CIM and WMI interfaces are very similar, we will discuss them together. The main difference is that the CIM is the newer interface, which is more powerful and more user-friendly. The CIM is also cross-platform, while the WMI is Windows-only.</p>
<p>The advantage of the CIM and WMI interfaces is that they are clear and object-oriented. The information can be queried using database-like operations. The disadvantage is that they are slow.</p>
<p>The main command for getting system information is:</p>
<ul>
<li><a href="https://learn.microsoft.com/en-us/powershell/module/cimcmdlets/get-ciminstance"><code>Get-CimInstance</code></a>: for CIM</li>
<li><a href="https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.management/get-wmiobject"><code>Get-WmiObject</code></a>: for WMI</li>
</ul>
<p>For both commands, we need to specify the class of the object we want to get using the <code>-ClassName</code> (CIM) or <code>-Class</code> (WMI) parameter. The classes are the same for both interfaces. Typical classes are:</p>
<ul>
<li><code>Win32_ComputerSystem</code>: information about the computer</li>
<li><code>Win32_OperatingSystem</code>: information about the operating system</li>
<li><a href="https://learn.microsoft.com/en-us/windows/win32/wmisdk/win32-installedwin32program"><code>Win32_InstalledWin32Program</code></a>: information about installed programs</li>
<li><a href="https://learn.microsoft.com/en-us/previous-versions/windows/desktop/legacy/aa394378(v=vs.85)"><code>Win32_Product</code></a>: information about programs installed using the MSI installer<ul>
<li>contains more information than <code>Win32_InstalledWin32Program</code></li>
</ul>
</li>
</ul>
<h2 id="windows-registry">Windows Registry<a class="headerlink" href="#windows-registry" title="Permanent link">&para;</a></h2>
<p>To access the Windows registry, we use the same commands that are used for file system:</p>
<ul>
<li><a href="https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.management/get-itemproperty"><code>Get-ItemProperty</code></a>: to get the value of a registry key</li>
<li><a href="https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.management/get-childitem"><code>Get-ChilItem</code></a> to get a list of child keys</li>
</ul>
<h1 id="advanced-script-blocks">Advanced Script blocks<a class="headerlink" href="#advanced-script-blocks" title="Permanent link">&para;</a></h1>
<p>Any script block can be made an advanced script block. Advanced script blocks are run similarly to the compiled cmdlets. To make a script block an advanced script block, we have to use the <code>[CmdletBinding()]</code> attribute at the beginning of the script block. </p>
<p>Example:</p>
<pre><code class="language-PowerShell">function MyFunction {
    [CmdletBinding()]
    # do something
}
</code></pre>
<p>The advanced functions and scripts have the following features:</p>
<ul>
<li>parameters are not available as <code>$args</code> (have to be parsed using the <code>param</code> block)</li>
<li>builtin parameters like <code>-Verbose</code>, <code>-Debug</code>, <code>-WarningAction</code>, <code>-InformationAction</code> are parsed automatically</li>
<li>support for pipeline input</li>
</ul>
<h1 id="elevation">Elevation<a class="headerlink" href="#elevation" title="Permanent link">&para;</a></h1>
<p>Some commands may require administrator privileges. Therefore, it is wise to check if the script is running with administrator privileges so that the execution is not interrupted. To check if the script is running with administrator privileges, use the following code:</p>
<pre><code class="language-PowerShell">$myWindowsID=[Security.Principal.WindowsIdentity]::GetCurrent()
$myWindowsPrincipal=new-object Security.Principal.WindowsPrincipal($myWindowsID)
if (!$myWindowsPrincipal.IsInRole([Security.Principal.WindowsBuiltInRole]::Administrator)) {
        Write-Host &quot;This script requires elevated privileges. Please run it as an administrator.&quot;
        exit
    }
</code></pre>
<p>Another solution may be to restart the script with administrator privileges. However, this has several limitations:</p>
<ul>
<li>when the script is run with administrator privileges a new terminal window is opened</li>
<li>parameters are not passed automatically to the new script. We can manually pass them using the <code>-ArgumentList</code> parameter. However, this is problematic for non-string parameters, especially in an advanced script block. </li>
</ul>
<p>To restart the script with administrator privileges, use the following code:</p>
<pre><code class="language-PowerShell">$argString = $args -join ' '
Start-Process &quot;pwsh&quot; -Verb RunAs -ArgumentList &quot;-noexit -File `&quot;$PSCommandPath`&quot; $argString&quot;
exit
</code></pre>
<h1 id="powershell-history">PowerShell History<a class="headerlink" href="#powershell-history" title="Permanent link">&para;</a></h1>
<p>To iterate over the commands used in the past, we use the <code>up arrow</code> and <code>down arrow</code> keys.</p>
<p>To list the history, use the <code>Get-History</code> command.</p>
<p>To <strong>clear</strong> the history, use the <a href="https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/clear-history"><code>Clear-History</code></a> command:</p>
<ul>
<li><code>Clear-History -Id &lt;id&gt;</code>: clear the command with the specified id (use <code>Get-History</code> to get the id)</li>
<li><code>Clear-History -Count &lt;count&gt;</code>: clear the last <code>count</code> commands</li>
<li><code>Clear-History -CommandLine &lt;pattern&gt;</code>: clear the commands that match the pattern. The pattern use the simple matching (e.g. <code>*</code> is the wildcard), and have to be wrapped in quotes if it contains spaces.</li>
</ul>
<h1 id="usefull-commands">Usefull Commands<a class="headerlink" href="#usefull-commands" title="Permanent link">&para;</a></h1>
<h2 id="file-encoding-conversion">File Encoding Conversion<a class="headerlink" href="#file-encoding-conversion" title="Permanent link">&para;</a></h2>
<p><code>gc [INPUT PATH] | Out-File -en [ENCODING] [OUTPUT PATH]</code></p>
<p>example: </p>
<pre><code>gc &quot;C:\AIC data\Roadmaptools big data test/map-filtered.osm&quot; | Out-File -en utf8 &quot;C:\AIC data\Roadmaptools big data test/map-filtered-utf8.osm&quot;
</code></pre>
<p>NOTE: it is not very fast :)</p>
<h2 id="delete-all-files-with-a-certain-extension">Delete all files with a certain extension<a class="headerlink" href="#delete-all-files-with-a-certain-extension" title="Permanent link">&para;</a></h2>
<pre><code>ls *.extension -Recurse | foreach {rm $_}
</code></pre>
<p>to try it, add the <code>-WhatIf</code> parameter to <code>rm</code></p>
<h2 id="batch-rename">Batch rename<a class="headerlink" href="#batch-rename" title="Permanent link">&para;</a></h2>
<p>Example</p>
<pre><code class="language-ps">dir . | % { $newName = $_.Name -replace '^DSC_0(.*)', 'DSC_1$1'; rename-item -newname $newName -literalPath $_.Fullname -whatif}
</code></pre>
<h2 id="count-lines-in-large-file">Count Lines in large file<a class="headerlink" href="#count-lines-in-large-file" title="Permanent link">&para;</a></h2>
<p><code>switch -File FILE { default { ++$count } }</code></p>
<h2 id="get-help">Get Help<a class="headerlink" href="#get-help" title="Permanent link">&para;</a></h2>
<p><a href="https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/get-help">Mirosoft documentation</a></p>
<p>To get help about a command, use the <code>Get-Help</code> (alias <code>man</code>) command. Example:</p>
<pre><code class="language-PowerShell">Get-Help Get-ChildItem
</code></pre>
<p>If the output is the list of articles, it means that there is no help for the command. </p>
<h2 id="translate-alias-to-command">Translate alias to command<a class="headerlink" href="#translate-alias-to-command" title="Permanent link">&para;</a></h2>
<p>To translate an alias to a command, use the <code>Get-Alias</code> command. Example:</p>
<pre><code class="language-PowerShell">Get-Alias ls # returns Get-ChildItem
</code></pre>
<h2 id="get-the-path-of-the-current-script">Get the path of the current script<a class="headerlink" href="#get-the-path-of-the-current-script" title="Permanent link">&para;</a></h2>
<p>To get the path of the current script, use the <code>$PSCommandPath</code> variable.</p>
<h2 id="compute-the-hash-of-a-file">Compute the hash of a file<a class="headerlink" href="#compute-the-hash-of-a-file" title="Permanent link">&para;</a></h2>
<p>To compute the hash of a file, use the <code>Get-FileHash</code> command. Example:</p>
<pre><code class="language-PowerShell">Get-FileHash &quot;C:\Users\user\file.txt&quot;
</code></pre>
<p>Important parameters:</p>
<ul>
<li><code>-Algorithm</code>: the algorithm used for hashing. The default is <code>SHA256</code>. Other options are <code>SHA1</code>, <code>SHA256</code>, <code>SHA384</code>, <code>SHA512</code>, <code>MD5</code></li>
</ul></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js" defer></script>
        <script src="../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>

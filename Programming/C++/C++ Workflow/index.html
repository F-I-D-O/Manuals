<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../../img/favicon.ico">
        <title>C++ Workflow - Manuals</title>
        <link href="../../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css">
        <link href="../../../extra.css" rel="stylesheet">

        <script src="../../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../../..">Manuals</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="dropdown active">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Programming <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">C++</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../C%20Manual/" class="dropdown-item">C Manual</a>
</li>
            
<li>
    <a href="../C%2B%2B%20Debugging%20and%20Profiling/" class="dropdown-item">C++ Debugging and Profiling</a>
</li>
            
<li>
    <a href="../C%2B%2B%20Manual/" class="dropdown-item">C++ Manual</a>
</li>
            
<li>
    <a href="./" class="dropdown-item active">C++ Workflow</a>
</li>
            
<li>
    <a href="../CMake%20Manual/" class="dropdown-item">CMake Manual</a>
</li>
            
<li>
    <a href="../Google%20Test/" class="dropdown-item">Google Test</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Database</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../Database/Database%20Workflow/" class="dropdown-item">Database Workflow</a>
</li>
            
<li>
    <a href="../../Database/PostgreSQL%20Debugging%20and%20Profiling/" class="dropdown-item">PostgreSQL Debugging and Profiling</a>
</li>
            
<li>
    <a href="../../Database/PostgreSQL%20Manual/" class="dropdown-item">PostgreSQL Manual</a>
</li>
            
<li>
    <a href="../../Database/SQL%20Manual/" class="dropdown-item">SQL Manual</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Java</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../Java/Debugging%20Java/" class="dropdown-item">Debugging Java</a>
</li>
            
<li>
    <a href="../../Java/Jackson/" class="dropdown-item">Jackson</a>
</li>
            
<li>
    <a href="../../Java/Java%20Manual/" class="dropdown-item">Java Manual</a>
</li>
            
<li>
    <a href="../../Java/Java%20Workflow/" class="dropdown-item">Java Workflow</a>
</li>
            
<li>
    <a href="../../Java/Maven/" class="dropdown-item">Maven</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Python</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../Python/Matplotlib%20Manual/" class="dropdown-item">Matplotlib Manual</a>
</li>
            
<li>
    <a href="../../Python/Pandas%20Manual/" class="dropdown-item">Pandas Manual</a>
</li>
            
<li>
    <a href="../../Python/Plotly%20Manual/" class="dropdown-item">Plotly Manual</a>
</li>
            
<li>
    <a href="../../Python/Python%20Debugging/" class="dropdown-item">Python Debugging</a>
</li>
            
<li>
    <a href="../../Python/Python%20Manual/" class="dropdown-item">Python Manual</a>
</li>
            
<li>
    <a href="../../Python/Python%20Workflow/" class="dropdown-item">Python Workflow</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Web</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../Web/CSS%20Manual/" class="dropdown-item">CSS Manual</a>
</li>
            
<li>
    <a href="../../Web/css/" class="dropdown-item">css</a>
</li>
            
<li>
    <a href="../../Web/Google%20API%20and%20Apps%20Script/" class="dropdown-item">Google API and Apps Script</a>
</li>
            
<li>
    <a href="../../Web/htaccess/" class="dropdown-item">htaccess</a>
</li>
            
<li>
    <a href="../../Web/JavaScript/" class="dropdown-item">JavaScript</a>
</li>
            
<li>
    <a href="../../Web/Jekyll/" class="dropdown-item">Jekyll</a>
</li>
            
<li>
    <a href="../../Web/mkdocs/" class="dropdown-item">mkdocs</a>
</li>
    </ul>
  </li>
                                    
<li>
    <a href="../../Common/" class="dropdown-item">Common</a>
</li>
                                    
<li>
    <a href="../../Git/" class="dropdown-item">Git</a>
</li>
                                    
<li>
    <a href="../../Gurobi/" class="dropdown-item">Gurobi</a>
</li>
                                    
<li>
    <a href="../../HDF/" class="dropdown-item">HDF</a>
</li>
                                    
<li>
    <a href="../../JSON/" class="dropdown-item">JSON</a>
</li>
                                    
<li>
    <a href="../../Native%20Libraries/" class="dropdown-item">Native Libraries</a>
</li>
                                    
<li>
    <a href="../../Perl/" class="dropdown-item">Perl</a>
</li>
                                    
<li>
    <a href="../../Regex/" class="dropdown-item">Regex</a>
</li>
                                    
<li>
    <a href="../../Ruby%20Workflow/" class="dropdown-item">Ruby Workflow</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">LaTeX <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../LaTeX/Latex%20manual/" class="dropdown-item">Latex manual</a>
</li>
                                    
<li>
    <a href="../../../LaTeX/LaTeX%20workflow/" class="dropdown-item">LaTeX workflow</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Linux <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../Linux/Linux%20Manual/" class="dropdown-item">Linux Manual</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Windows <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../Windows/Excel%20Manual/" class="dropdown-item">Excel Manual</a>
</li>
                                    
<li>
    <a href="../../../Windows/PowerPoint/" class="dropdown-item">PowerPoint</a>
</li>
                                    
<li>
    <a href="../../../Windows/Powershell%20Manual/" class="dropdown-item">Powershell Manual</a>
</li>
                                    
<li>
    <a href="../../../Windows/VSCode/" class="dropdown-item">VSCode</a>
</li>
                                    
<li>
    <a href="../../../Windows/Windows%20Manual/" class="dropdown-item">Windows Manual</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Audio & Video <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../Audio%20%26%20Video/FFMpeg/" class="dropdown-item">FFMpeg</a>
</li>
                                    
<li>
    <a href="../../../Audio%20%26%20Video/VLC/" class="dropdown-item">VLC</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Cloud computing <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../Cloud%20computing/Lmod/" class="dropdown-item">Lmod</a>
</li>
                                    
<li>
    <a href="../../../Cloud%20computing/RCI%20cluster/" class="dropdown-item">RCI cluster</a>
</li>
                                    
<li>
    <a href="../../../Cloud%20computing/Slurm/" class="dropdown-item">Slurm</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">GIS <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../GIS/GIS%20formats/" class="dropdown-item">GIS formats</a>
</li>
                                    
<li>
    <a href="../../../GIS/Overpass%20Manual/" class="dropdown-item">Overpass Manual</a>
</li>
                                    
<li>
    <a href="../../../GIS/QGIS/" class="dropdown-item">QGIS</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Images <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../Images/Midjourney/" class="dropdown-item">Midjourney</a>
</li>
                                    
<li>
    <a href="../../../Images/Photopea/" class="dropdown-item">Photopea</a>
</li>
                                </ul>
                            </li>
                            <li class="navitem">
                                <a href="../../../Arxiv/" class="nav-link">Arxiv</a>
                            </li>
                            <li class="navitem">
                                <a href="../../../Google%20office%20apps/" class="nav-link">Google office apps</a>
                            </li>
                            <li class="navitem">
                                <a href="../../.." class="nav-link">index</a>
                            </li>
                            <li class="navitem">
                                <a href="../../../Markdown/" class="nav-link">Markdown</a>
                            </li>
                            <li class="navitem">
                                <a href="../../../Network/" class="nav-link">Network</a>
                            </li>
                            <li class="navitem">
                                <a href="../../../Security/" class="nav-link">Security</a>
                            </li>
                            <li class="navitem">
                                <a href="../../../vscode/" class="nav-link">vscode</a>
                            </li>
                            <li class="navitem">
                                <a href="../../../Web%20Tricks/" class="nav-link">Web Tricks</a>
                            </li>
                            <li class="navitem">
                                <a href="../../../XML/" class="nav-link">XML</a>
                            </li>
                            <li class="navitem">
                                <a href="../../../YAML/" class="nav-link">YAML</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../C%2B%2B%20Manual/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../CMake%20Manual/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#introduction" class="nav-link">Introduction</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#compiler-toolchains" class="nav-link">Compiler Toolchains</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#msys2-windows" class="nav-link">MSYS2 (Windows)</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#msvc-windows" class="nav-link">MSVC (Windows)</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="3"><a href="#common-compiler-flags" class="nav-link">Common Compiler Flags</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#gcc-linuxwsl" class="nav-link">GCC (Linux/WSL)</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="3"><a href="#installation" class="nav-link">Installation</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#g" class="nav-link">g++</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#build-sequencing-tools" class="nav-link">Build Sequencing Tools</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#make" class="nav-link">Make</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#msbuild" class="nav-link">MSBuild</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#cmake" class="nav-link">Cmake</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#vcpkg" class="nav-link">vcpkg</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#basic-coomands" class="nav-link">Basic coomands</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="3"><a href="#install-a-package" class="nav-link">Install a package</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#remove-a-package" class="nav-link">Remove a package</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#search-for-a-package" class="nav-link">Search for a package</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#list-installed-packages" class="nav-link">List installed packages</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#cmake-integration" class="nav-link">CMake Integration</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#directory-structure" class="nav-link">Directory Structure</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="3"><a href="#modules" class="nav-link">Modules</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#triplets" class="nav-link">Triplets</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="3"><a href="#changing-the-default-triplet" class="nav-link">Changing the default triplet</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#using-a-custom-triplet" class="nav-link">Using a custom triplet</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#update" class="nav-link">Update</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#update-package" class="nav-link">Update package</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="3"><a href="#upgrade-packages-matching-a-pattern" class="nav-link">Upgrade packages matching a pattern</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#package-features" class="nav-link">Package Features</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#package-versions" class="nav-link">Package Versions</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#integrate-your-library-to-vcpkg" class="nav-link">Integrate your library to vcpkg</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="3"><a href="#create-the-port" class="nav-link">Create the Port</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="4"><a href="#variables-and-functions-available-in-the-portfilecmake" class="nav-link">Variables and Functions available in the portfile.cmake</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#installation_1" class="nav-link">Installation</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="4"><a href="#reinistallation-after-changes" class="nav-link">Reinistallation after changes</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="4"><a href="#executable-installation" class="nav-link">Executable installation</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="4"><a href="#executing-installed-tools-from-cmake" class="nav-link">Executing installed tools from cmake</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#publishing" class="nav-link">Publishing</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#ide" class="nav-link">IDE</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#clion" class="nav-link">Clion</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="3"><a href="#configuration" class="nav-link">Configuration</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="4"><a href="#set-default-layout" class="nav-link">Set default layout</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="4"><a href="#set-up-the-new-nova-engine" class="nav-link">Set up the new Nova engine</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="4"><a href="#set-up-new-surround-with-template" class="nav-link">Set up new surround with template</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#toolchain-configuration" class="nav-link">Toolchain configuration</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="4"><a href="#multiple-wsl-toolchains" class="nav-link">Multiple WSL toolchains</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#project-configuration" class="nav-link">Project configuration</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="4"><a href="#wsl-extra-configuration" class="nav-link">WSL extra configuration</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="4"><a href="#configuring-only-some-cmake-profiles" class="nav-link">Configuring only some CMake profiles</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#problems" class="nav-link">Problems</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="4"><a href="#editor-reports-errors-despite-the-code-compiles-in-all-compilers" class="nav-link">Editor reports errors despite the code compiles in all compilers</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#visual-studio" class="nav-link">Visual Studio</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="3"><a href="#installation_2" class="nav-link">Installation</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#setting-synchronization" class="nav-link">Setting Synchronization</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#basic-configuration" class="nav-link">Basic Configuration</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="4"><a href="#enable-template-implementation-files-tpp-syntax-highlighting" class="nav-link">Enable template implementation files (.*tpp) syntax highlighting:</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="4"><a href="#to-change-the-build-verbosity" class="nav-link">To Change the Build Verbosity</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#project-setting" class="nav-link">Project Setting</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="4"><a href="#configure-visual-studio-to-use-system-cmake" class="nav-link">Configure Visual Studio to use system CMake:</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="4"><a href="#build-setting-and-enviromental-variables" class="nav-link">Build Setting and Enviromental Variables</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="5"><a href="#set-the-cmake-toolchain-file" class="nav-link">Set the CMake Toolchain File</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="5"><a href="#set-the-compiler" class="nav-link">Set the Compiler</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="5"><a href="#old-method-using-cmakesettingsjson" class="nav-link">Old Method Using CMakeSettings.json</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            <li class="nav-item" data-level="4"><a href="#launch-setting" class="nav-link">Launch Setting</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="5"><a href="#other-launchvsjson-options" class="nav-link">Other launch.vs.json options</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#wsl-configuration" class="nav-link">WSL Configuration</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#other-configuration" class="nav-link">Other Configuration</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#determine-visual-studio-version" class="nav-link">Determine Visual Studio version</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#problems-solutions" class="nav-link">Problems &amp; solutions</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="4"><a href="#cannot-regenerate-cmake-cache" class="nav-link">Cannot regenerate Cmake cache</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
              </ul>
            </li>
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#typical-directory-structure" class="nav-link">Typical directory structure</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#dependencies" class="nav-link">Dependencies</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#vcpkg-libraries" class="nav-link">Vcpkg Libraries</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="3"><a href="#boost" class="nav-link">Boost</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#jni" class="nav-link">JNI</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#gurobi" class="nav-link">Gurobi</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="3"><a href="#update-gurobi" class="nav-link">Update Gurobi</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#other-libraries-not-available-in-vcpkg" class="nav-link">Other Libraries Not Available in vcpkg</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="3"><a href="#test-library-linkinginclusion" class="nav-link">Test Library linking/inclusion</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#dependencies-with-wsl-and-clion" class="nav-link">Dependencies with WSL and CLion</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#refactoring" class="nav-link">Refactoring</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#changing-method-signature" class="nav-link">Changing Method Signature</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#standard-library" class="nav-link">Standard Library</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#linking-to-the-standard-library" class="nav-link">Linking to the Standard Library</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="3"><a href="#setting-up-the-correct-crt-with-msvc" class="nav-link">Setting up the correct CRT with MSVC</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#resouces" class="nav-link">Resouces</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#exporting-symbols-for-shared-libraries" class="nav-link">Exporting symbols for shared libraries</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#creating-the-export-header" class="nav-link">Creating the Export Header</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#marking-the-symbols" class="nav-link">Marking the Symbols</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#cmake-configuration" class="nav-link">CMake Configuration</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#resouces_1" class="nav-link">Resouces</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#compilation-for-a-specific-cpu" class="nav-link">Compilation for a specific CPU</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#msvc" class="nav-link">MSVC</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#building" class="nav-link">Building</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="3"><a href="#specify-the-build-type-debug-release" class="nav-link">Specify the build type (Debug, Release)</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="4"><a href="#single-configuration-systems" class="nav-link">Single-configuration systems</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="4"><a href="#multi-configuration-systems" class="nav-link">Multi-configuration systems</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#specify-the-target" class="nav-link">Specify the target</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#clean-the-source-files" class="nav-link">Clean the source files</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#handling-case-insensitivity" class="nav-link">Handling Case Insensitivity</a>
              <ul class="nav flex-column">
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h1>
<p>In C++, the workflow and especially the build pipeline is much more complicated than in other languages. Therefore, we start with brief overview of the C++ build pipelines. The following scheme shows the possible build pipelines for C++, starting from Integrated developemnt tools (IDE) and ending with the linker.</p>
<p><img alt="C++ Workflow" src="../Build%20tools%20and%20toolsets.png" /></p>
<p>This guide presents mostly the following workflows:</p>
<ul>
<li>Clion or Visual Studio IDE</li>
<li>CMake</li>
<li>any sequencing tool (these are discribed only briefly as they are configured automaticvally by CMake)</li>
<li>MSVC and GCC compiler toolchains</li>
</ul>
<p>Appart from the build pipeline, we also cover the dependency management. For this, we focus on the dependency manager vcpkg.</p>
<h1 id="compiler-toolchains">Compiler Toolchains<a class="headerlink" href="#compiler-toolchains" title="Permanent link">&para;</a></h1>
<p>There are various toolchains available on Windows and Linux, but we limit this guide for only some of them, specifically those which are frequently updated and works great with Clion.</p>
<h2 id="msys2-windows">MSYS2 (Windows)<a class="headerlink" href="#msys2-windows" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="https://www.msys2.org/">download</a></li>
<li>follow the installation guide on the homepage</li>
<li>install MinGW64 using: <code>pacman -S mingw-w64-x86_64-gcc</code></li>
</ul>
<h2 id="msvc-windows">MSVC (Windows)<a class="headerlink" href="#msvc-windows" title="Permanent link">&para;</a></h2>
<ul>
<li>install <a href="https://visualstudio.microsoft.com/cs/vs/">Visual Studio 2019 Comunity Edition</a></li>
</ul>
<h3 id="common-compiler-flags">Common Compiler Flags<a class="headerlink" href="#common-compiler-flags" title="Permanent link">&para;</a></h3>
<ul>
<li><a href="https://learn.microsoft.com/en-us/cpp/build/reference/nologo-suppress-startup-banner-c-cpp"><code>/nologo</code></a>: do not print the copyright banner and information messages</li>
<li><a href="https://learn.microsoft.com/en-us/cpp/build/reference/eh-exception-handling-model"><code>/EH</code></a>: exception handeling flags</li>
</ul>
<h2 id="gcc-linuxwsl">GCC (Linux/WSL)<a class="headerlink" href="#gcc-linuxwsl" title="Permanent link">&para;</a></h2>
<h3 id="installation">Installation<a class="headerlink" href="#installation" title="Permanent link">&para;</a></h3>
<ol>
<li>If on Windows, <a href="https://docs.microsoft.com/en-us/windows/wsl/install-win10">Install the WSL</a> first (WSL 2)</li>
<li>check if GCC is installed by typing <code>gcc --version</code></li>
</ol>
<p>If GCC is not installed:</p>
<ol>
<li><code>sudo apt-get update</code></li>
<li><code>sudo apt-get upgrade</code></li>
<li><code>sudo apt-get install gcc-&lt;version&gt;</code></li>
</ol>
<h3 id="g">g++<a class="headerlink" href="#g" title="Permanent link">&para;</a></h3>
<p><code>g++</code> is the main executable for the GCC compiler. It is botha compiler and a wrapper for the linker. Typical usage is:</p>
<ul>
<li><code>g++ -o &lt;output file&gt; &lt;cpp files and library files&gt;</code>: compilation and linking </li>
<li><code>g++ -c &lt;cpp files&gt;</code>: compilation only</li>
<li><code>g++  -o &lt;output file&gt; &lt;object files and library files&gt;</code>: linking only</li>
</ul>
<p>Other frequently used flags are:</p>
<ul>
<li><code>-g</code>: include debug information</li>
<li><code>-l&lt;library&gt;</code>: link the library named <code>lib&lt;library&gt;</code>. Unlike direct library specification, here the linkers searches for the library in standard directories.</li>
</ul>
<h1 id="build-sequencing-tools">Build Sequencing Tools<a class="headerlink" href="#build-sequencing-tools" title="Permanent link">&para;</a></h1>
<h2 id="make">Make<a class="headerlink" href="#make" title="Permanent link">&para;</a></h2>
<p>Most of the time, make scripts should not be written manually, but generated by build script generators like CMake. Therefore, here, we describe the structure of make scripts as they are generated by CMake. The structure is:</p>
<ul>
<li><code>Makefile</code>: the main file that contains the rules for building the project</li>
<li><code>CMakeFiles</code>: a directory containing the files referenced in the <code>Makefile</code><ul>
<li><code>&lt;target name&gt;.dir</code> directory for each target<ul>
<li><code>link.txt</code>: the file containing the linking command</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="msbuild">MSBuild<a class="headerlink" href="#msbuild" title="Permanent link">&para;</a></h2>
<p>The MSBuild is a XML-based build sequencing tool. The scripts are typically generated by CMake or directly by Visual Studio.</p>
<p>The main file for each target is the <code>&lt;target name&gt;.vcxproj</code> file. All properties are stored in the root element <code>&lt;Project&gt;</code>. 
The structure inside the project element is as follows (only the most important elements are listed):</p>
<ul>
<li><code>&lt;ItemDefinitionGroup Condition="&lt;configuration&gt;"&gt;</code>: contains the properties for the given configuration.</li>
<li><code>&lt;ItemGroup&gt;&lt;multiple &lt;ClCompile&gt; elements&gt;&lt;ItemGroup&gt;</code>: contains the source files that are compiled</li>
<li><code>&lt;ItemGroup&gt;&lt;multiple &lt;ProjectReference&gt; elements&gt;&lt;ItemGroup&gt;</code>: contains references to other targets (dependencies). Theses targets are built before the current target.</li>
</ul>
<p>The propertis for each configuration are structured as follows:</p>
<ul>
<li><code>&lt;ClCompile&gt;</code>: contains the properties for the compilation of the source files (e.g., language standard, runtime library, etc.)</li>
<li><code>&lt;ResourceCompile&gt;</code>:<ul>
<li><code>&lt;PreprocessorDefinitions&gt;</code>: the preprocessor definitions used for the target. These are introduced either by the target itself or by the dependencies.</li>
</ul>
</li>
<li><code>&lt;Link&gt;</code>: contains the properties for the linking of the target (e.g., the libraries to link, the output file, etc.)</li>
</ul>
<h1 id="cmake">Cmake<a class="headerlink" href="#cmake" title="Permanent link">&para;</a></h1>
<ul>
<li>Windows: Install CMake from <a href="https://cmake.org/download/">https://cmake.org/download/</a><ul>
<li>if your CMake is too old (e.g. error: “CMake 3.15 or higher is required”), update CMake (same as new install)</li>
</ul>
</li>
<li>Linux:<ul>
<li>If cmake is installed already, uninstall it!</li>
<li>Do not use the cmake from linux repositories!!</li>
<li>Download CMake <code>sh</code> installer from <a href="https://cmake.org/download/">https://cmake.org/download/</a></li>
<li>install:<ol>
<li><code>sudo chmod +x &lt;INSTALLER&gt;</code></li>
<li><code>sudo &lt;INSTALLER&gt;</code></li>
<li><code>sudo rm &lt;INSTALLER&gt;</code></li>
</ol>
</li>
<li>add cmake executable to path</li>
</ul>
</li>
</ul>
<p>Other details about CMake can be found in the <a href="../CMake%20Manual/">CMake Manual</a>.</p>
<h1 id="vcpkg">vcpkg<a class="headerlink" href="#vcpkg" title="Permanent link">&para;</a></h1>
<p>Vcpkg is a package manager for C++ libraries it serves as a developement package manager rather than a system package manager.</p>
<p>Vcpkg can work in two modes:</p>
<ul>
<li><strong>Classic mode</strong>: vcpkg is installed centrally. This mode is useful for development and testing.</li>
<li><a href="https://learn.microsoft.com/en-us/vcpkg/concepts/manifest-mode"><strong>Manifest mode</strong></a>: vcpkg is installed in the project directory. This mode is useful for deployment. </li>
</ul>
<p>To install vcpkg:</p>
<ol>
<li>clone the repo to the desired location (project directory for manifest mode, any directory for classic mode)</li>
<li>run the bootstrap script (<code>bootstrap-vcpkg.bat</code> on Windows, <code>bootstrap-vcpkg.sh</code> on Linux)</li>
<li>for classic mode, add the vcpkg directory to <code>PATH</code>, so the program can be run from anywhere<ul>
<li>Beware that to run it with sudo on linux, <a href="https://docs.google.com/document/d/19CBUHtO0aUpg-kipnTrbQ3ozn_M1PiM0rH4IHoYrXS0/edit?usp=sharing">it is not that easy</a>.</li>
</ul>
</li>
</ol>
<h2 id="basic-coomands">Basic coomands<a class="headerlink" href="#basic-coomands" title="Permanent link">&para;</a></h2>
<h3 id="install-a-package">Install a package<a class="headerlink" href="#install-a-package" title="Permanent link">&para;</a></h3>
<p>To install a package, use the <code>install &lt;package name&gt;</code> command. Important options are:</p>
<ul>
<li><code>--triplet &lt;triplet&gt;</code>: the target triplet. </li>
</ul>
<h3 id="remove-a-package">Remove a package<a class="headerlink" href="#remove-a-package" title="Permanent link">&para;</a></h3>
<p>To remove a package, use the <code>remove &lt;package name&gt;</code> command. Important options are:</p>
<ul>
<li><code>--triplet &lt;triplet&gt;</code>: the target triplet.</li>
</ul>
<h3 id="search-for-a-package">Search for a package<a class="headerlink" href="#search-for-a-package" title="Permanent link">&para;</a></h3>
<p>To search for a package, use the <code>search &lt;package name&gt;</code> command. </p>
<h3 id="list-installed-packages">List installed packages<a class="headerlink" href="#list-installed-packages" title="Permanent link">&para;</a></h3>
<p>To list the installed packages, use the <code>list</code> command. The first positional argument is the triplet filter, e.g., <code>list x64-windows</code> lists only the packages for the <code>x64-windows</code> triplet.</p>
<h2 id="cmake-integration">CMake Integration<a class="headerlink" href="#cmake-integration" title="Permanent link">&para;</a></h2>
<p><a href="https://learn.microsoft.com/en-us/vcpkg/users/buildsystems/cmake-integration">documentation</a></p>
<p>By default, CMake does not see the vcpkg. To set up the appropriate enviroment variables, paths, etc., we need to run cmake commands with path to cmake toolchain file: <code>vcpkg/scripts/buildsystems/vcpkg.cmake</code>. See the IDE and command line section for the detailed instructions how to execute cmake with the path to the vcpkg toolchain file. </p>
<p>The toolchain file is executed early on, so it is safe to assume that the environment will be correctly set up before the commands in yor cmake script.</p>
<h2 id="directory-structure">Directory Structure<a class="headerlink" href="#directory-structure" title="Permanent link">&para;</a></h2>
<p>vcpkg has the following directory structure:</p>
<ul>
<li><code>buildtrees</code>: contains the build directories for each installed package. Each build directory contains the build logs.</li>
<li><code>installed</code>: contains the installed packages. It has subdirectories for each triplet. Each triplet directory is than divided into folloeing subdirectories:<ul>
<li><code>bin</code>: contains the shared libraries</li>
<li><code>debug</code>: contains the debug version of everything in a similar structure as the triplet directory</li>
<li><code>examples</code>: contains example binaries</li>
<li><code>include</code>: contains the header files</li>
<li><code>lib</code>: contains the static libraries</li>
<li><code>share</code>: contains the cmake scripts and other files needed for the integration of the package into a cmake project</li>
<li><code>tools</code>: contains the executables installed with vcpkg packages</li>
</ul>
</li>
<li><code>ports</code>: Contains the package information for each package from the official vcpkg list. There is no special way how to update just the port dir, so update the whole vcpkg by <code>git pull</code> in case you need to update the list of available packages.</li>
<li><code>scripts</code>: various scripts<ul>
<li><code>toolchains</code>: cmake files that configure the toolchains. There is a special file for each platform (windows, linux, etc.)</li>
</ul>
</li>
<li><code>triplets</code>: contains the triplet files.</li>
</ul>
<h3 id="modules">Modules<a class="headerlink" href="#modules" title="Permanent link">&para;</a></h3>
<p>Vcpkg has it s own <code>find_package</code> macro in the toolchain file. It executes the script: <code>vcpkg/installed/&lt;tripplet&gt;/share/&lt;package name&gt;/vcpkg-cmake-wrapper.cmake</code>, if exists. Then, it executes the cmake scripts in that directory using the standard <code>find_package</code>, like a cmake config package.</p>
<h2 id="triplets">Triplets<a class="headerlink" href="#triplets" title="Permanent link">&para;</a></h2>
<p><a href="https://learn.microsoft.com/en-us/vcpkg/concepts/triplets">documentation</a></p>
<p>Vcpkg supports installing packages built for multiple platforms and compilers in the same vcpkg installation. To do this, vcpkg uses the concept of <em>triplets</em>. A triplet is definition of target environment. Usually, the triplet defines three things:</p>
<ul>
<li>the target platform (e.g., x64, arm)</li>
<li>the target operating system (e.g., windows, linux)</li>
<li>the target compiler (e.g., msvc, gcc)</li>
</ul>
<p>The triplet definition is stored in the triplet file in the <code>&lt;vcpkg root&gt;/triplets</code> directory.</p>
<h3 id="changing-the-default-triplet">Changing the default triplet<a class="headerlink" href="#changing-the-default-triplet" title="Permanent link">&para;</a></h3>
<p>To change the default triplet, add a new system variable <code>VCPKG_DEFAULT_TRIPLET</code>, so your default library version installed with vcpkg will be x64 (like our builds),  set it to:</p>
<ul>
<li><code>x64-linux</code> for Linux Compilers</li>
<li><code>x64-windows</code> for MSVC</li>
<li><code>x64-MinGW</code> for MinGW</li>
</ul>
<h3 id="using-a-custom-triplet">Using a custom triplet<a class="headerlink" href="#using-a-custom-triplet" title="Permanent link">&para;</a></h3>
<p>If you need to test a specific system environment with vcpkg, you can use a custom triplet.</p>
<p>Typically, you can <strong>create</strong> such a triplet by copying an existing one and modifying it. Typically, you just modify the <a href="https://learn.microsoft.com/en-us/vcpkg/users/triplets">triplet variables</a> in the file.</p>
<p>To <strong>use</strong> the custom triplet add two arguments to the vcpkg command:</p>
<ul>
<li><code>--triplet &lt;triplet name&gt;</code>: the name of the custom triplet</li>
<li><code>--overlay-triplets=&lt;path to the directory containing the custom triplet&gt;</code>: the path to the directory containing the custom triplet file</li>
</ul>
<p>To <strong>change the compiler</strong>, it is a little bit more complicated, as there is no triplet variable for the compiler. Instead, we need to provide a custom toolchain:</p>
<ol>
<li>copy an existing toolchain file from the <code>&lt;vcpkg root&gt;/scripts/toolchains</code>.</li>
<li>modify the toolchain file to use the desired compiler, e.g., by setting the <code>CMAKE_CXX_COMPILER</code> variable.</li>
<li>in the custom triplet file, set the <code>VCPKG_CHAINLOAD_TOOLCHAIN_FILE</code> variable to point to the custom toolchain file.</li>
</ol>
<h2 id="update">Update<a class="headerlink" href="#update" title="Permanent link">&para;</a></h2>
<ol>
<li><code>git pull</code></li>
<li>bootstrap vcpkg again<ol>
<li>Windows: <code>bootstrap-vcpkg.bat</code>   </li>
<li>Linux: <code>bootstrap-vcpkg.sh</code></li>
</ol>
</li>
</ol>
<h2 id="update-package">Update package<a class="headerlink" href="#update-package" title="Permanent link">&para;</a></h2>
<ol>
<li><a href="#update">Update vcpkg</a></li>
<li><code>vcpkg update</code> to get a list of available updates</li>
<li><code>vcpkg upgrade --no-dry-run</code> to actually perform the upgrade</li>
</ol>
<p>All packages are upgraded by default. To upgrade just one package, supply the name of the package (e.g., zlib:x64-windows) as an argument to <code>upgrade</code> command.</p>
<h3 id="upgrade-packages-matching-a-pattern">Upgrade packages matching a pattern<a class="headerlink" href="#upgrade-packages-matching-a-pattern" title="Permanent link">&para;</a></h3>
<p>For libraries that are divided into many interdependent packages (like boost), it is useful to upgrade all packages that match a pattern at once. Unfortunately, the <code>upgrade</code> command does not support the pattern matching. The following command can be used to upgrade all packages that match a pattern in PowerShell:</p>
<pre><code class="language-PowerShell">vcpkg update | sls -pattern &quot;boost-\w+&quot; | foreach-object { vcpkg upgrade $_.Matches.Value --no-dry-run }
</code></pre>
<h2 id="package-features">Package Features<a class="headerlink" href="#package-features" title="Permanent link">&para;</a></h2>
<p>Some libraries have optional features, which are not installed by default, but we can install them explicitely. For example <code>llvm</code>. After <code>vcpkg install llvm</code> and typing <code>vcpkg search llvm</code>:</p>
<pre><code>llvm                 10.0.0#6         The LLVM Compiler Infrastructure
llvm[clang]                           Build C Language Family Front-end.
llvm[clang-tools-extra]               Build Clang tools.
...
llvm[target-all]                      Build with all backends.
llvm[target-amdgpu]                   Build with AMDGPU backend.
llvm[target-arm]                      Build with ARM backend.
</code></pre>
<p>Above, we can see that there are a lot of optional targets. To install the the arm target, for example, we can use <code>vcpkg install llvm[target-arm]</code>. Sometimes, a new build of the main package is required, in that case, we need to type <code>vcpkg install llvm[target-arm] --recurse</code>.</p>
<h2 id="package-versions">Package Versions<a class="headerlink" href="#package-versions" title="Permanent link">&para;</a></h2>
<p>In classic mode, there is no way how to control the version of a package. For that, we have to use the manifest mode</p>
<h2 id="integrate-your-library-to-vcpkg">Integrate your library to vcpkg<a class="headerlink" href="#integrate-your-library-to-vcpkg" title="Permanent link">&para;</a></h2>
<p>For complete integration of your library to vcpkg, the following steps are needed:</p>
<ol>
<li>Configure and test the <a href="../CMake%20Manual/#install"><em>CMake installation</em></a></li>
<li>Crate the port and test it locally (<em>vcpkg installation</em>)</li>
<li>Submit the port to the vcpkg repository (<em>publishing</em>) </li>
</ol>
<p>Resources:</p>
<ul>
<li><a href="https://decovar.dev/blog/2022/10/30/cpp-dependencies-with-vcpkg/">decovar tutorial</a></li>
</ul>
<h3 id="create-the-port">Create the Port<a class="headerlink" href="#create-the-port" title="Permanent link">&para;</a></h3>
<ul>
<li><a href="https://learn.microsoft.com/en-us/vcpkg/get_started/get-started-packaging">The official guide for packageing</a></li>
<li><a href="https://learn.microsoft.com/en-us/vcpkg/contributing/maintainer-guide">Maintainer guide</a><ul>
<li>missing details from other guides</li>
<li>contains the list of deprecated functions</li>
</ul>
</li>
</ul>
<p>Vcpkg works with ports which are special directories containing all files describing a C++ package. The usuall process is:
The usual port contain these files:</p>
<ul>
<li><code>portfile.cmake</code>: the main file containing the calls to cmake functions that install the package</li>
<li><code>vcpkg.json</code>: metadata file containing the package name, version, dependencies, etc.</li>
<li><code>usage</code>: a file containing the usage instructions for the package. These instructions are displayed at the end of the installation process.<ul>
<li><a href="https://github.com/microsoft/vcpkg-docs/blob/main/vcpkg/examples/adding-usage.md">example</a></li>
</ul>
</li>
</ul>
<p>A simple <code>portfile.cmake</code> can look like this:</p>
<pre><code class="language-cmake">
# download the source code
vcpkg_from_github(
    OUT_SOURCE_PATH SOURCE_PATH
    REPO &lt;reo owner&gt;/&lt;repo name&gt;
    REF &lt;tag name&gt;
    SHA512 &lt;hash of the files&gt;
    HEAD_REF &lt;branch name&gt;
)

# configure the source code
vcpkg_cmake_configure(
    SOURCE_PATH &lt;path to source dir&gt;
)

# build the source code and install it
vcpkg_cmake_install()

# fix the cmake generaed files for vcpkg
vcpkg_cmake_config_fixup(PACKAGE_NAME &lt;package name&gt;)

# install the license
vcpkg_install_copyright(FILE_LIST &quot;${SOURCE_PATH}/LICENSE.txt&quot;)

# install the usage file
file(INSTALL &quot;${CMAKE_CURRENT_LIST_DIR}/usage&quot; DESTINATION &quot;${CURRENT_PACKAGES_DIR}/share/${PORT}&quot;)
</code></pre>
<p>Explanation:</p>
<ul>
<li><a href="https://learn.microsoft.com/en-us/vcpkg/maintainers/functions/vcpkg_from_github"><code>vcpkg_from_github</code></a>: downloads the source code from the github repository<ul>
<li>the <code>&lt;path to source dir&gt;</code> is the directory where the <code>CMakeLists.txt</code> file is located. It is usually the directory where the source code is downloaded, so we can set it to <code>${SOURCE_PATH}</code></li>
<li>the <code>&lt;hash of the files&gt;</code> can be easily obtained by:<ol>
<li>setting the `<hash of files> to 0</li>
<li>running the <code>vcpkg install &lt;port name&gt;</code></li>
<li>copying the hash from the error message</li>
</ol>
</li>
</ul>
</li>
<li><a href="https://learn.microsoft.com/en-us/vcpkg/maintainers/functions/vcpkg_cmake_configure"><code>vcpkg_cmake_configure</code></a>: configures the source code using cmake (wraps the <code>cmake</code> command)</li>
<li><a href="https://learn.microsoft.com/en-us/vcpkg/maintainers/functions/vcpkg_cmake_install"><code>vcpkg_cmake_install</code></a>: builds and installs the source code (wraps the <code>cmake --build . --target install</code> command)<ul>
<li>the majority of code is in the subroutine <a href="https://learn.microsoft.com/en-us/vcpkg/maintainers/functions/vcpkg_cmake_build"><code>vcpkg_cmake_build</code></a></li>
<li><strong>if we need some libraries installed with vcpkg at runtime during the build of the package, we need to use the <code>ADD_BIN_TO_PATH</code> option in the <code>vcpkg_cmake_install</code> function</strong>. This is needed as the automatic dll copy to the output dir (<code>VCPKG_APPLOCAL_DEPS</code>) is disabelled by the <code>vcpkg_cmake_build</code> function. This option solve the problem by prepending the <code>PATH</code> environment variable with the path to the vcpkg installed libraries (<code>&lt;vcpkg root&gt;/installed/&lt;triplet&gt;/bin</code> for release and <code>&lt;vcpkg root&gt;/installed/&lt;triplet&gt;/debug/bin</code> for debug).</li>
</ul>
</li>
<li><a href="https://learn.microsoft.com/en-us/vcpkg/maintainers/functions/vcpkg_cmake_config_fixup"><code>vcpkg_cmake_config_fixup</code></a>: fixes the cmake generated files for vcpkg. This is needed because the cmake generated files are not compatible with vcpkg. The function fixes the <code>CMakeConfig.cmake</code> and <code>CMakeConfigVersion.cmake</code> files.<ul>
<li>the <code>&lt;package name&gt;</code> is the name of the package, usually the same as the port name</li>
</ul>
</li>
<li><a href="https://learn.microsoft.com/en-us/vcpkg/maintainers/functions/vcpkg_install_copyright"><code>vcpkg_install_copyright</code></a> installs the license files listed in the <code>FILE_LIST</code> argument to <code>share/&lt;port name&gt;/copyright</code> file. The <code>copyright</code> file is obligatory for the package to be accepted to the vcpkg repository.</li>
</ul>
<p>The <code>vcpkg.json</code> file can look like this:</p>
<pre><code class="language-json">{
    {
    &quot;name&quot;: &quot;fconfig&quot;,
    &quot;version-string&quot;: &quot;0.1.0&quot;,
    &quot;description&quot;: &quot;C++ implementation of the fconfig configuration system&quot;,
    &quot;homepage&quot;: &quot;https://github.com/F-I-D-O/Future-Config&quot;,
    &quot;license&quot;: &quot;MIT&quot;,
    &quot;dependencies&quot;: [
        {
            &quot;name&quot; : &quot;vcpkg-cmake&quot;,
            &quot;host&quot; : true
        },
        &quot;yaml-cpp&quot;,
        &quot;spdlog&quot;,
        &quot;inja&quot;
    ]
}
}
</code></pre>
<p>Here:</p>
<ul>
<li>the <code>license</code> key is obligatory and has to match the license file of the package</li>
<li>The dependencies with the <code>host</code> key set to <code>true</code> are the dependencies that are required for the build, but not for the runtime. </li>
</ul>
<h4 id="variables-and-functions-available-in-the-portfilecmake">Variables and Functions available in the portfile.cmake<a class="headerlink" href="#variables-and-functions-available-in-the-portfilecmake" title="Permanent link">&para;</a></h4>
<p>The variables and functions available in the <code>portfile.cmake</code> are described in the <a href="https://learn.microsoft.com/en-us/vcpkg/commands/create">create command documentation</a>. The most important variables are:</p>
<ul>
<li><code>CURRENT_PACKAGES_DIR</code>: the directory where the package is installed: <code>&lt;vcpkg root&gt;/installed/&lt;triplet&gt;/&lt;port name&gt;</code></li>
</ul>
<h3 id="installation_1">Installation<a class="headerlink" href="#installation_1" title="Permanent link">&para;</a></h3>
<p>To install the port locally, run:</p>
<pre><code class="language-bash">vcpkg install &lt;port name&gt;
</code></pre>
<p>For this command to work, the port has to be located in <code>&lt;vcpkg root&gt;/ports/&lt;port name&gt;</code>. If we want to install the port from an alternative location, we can use the <code>--overlay-ports</code> option.  For example, if we have the port stored in the <code>C:/custom_ports/our_new_port</code> directory, we can install it by:</p>
<pre><code class="language-bash">vcpkg install our_new_port --overlay-ports=C:/custom_ports
</code></pre>
<p>If the port installation is failing and the reason is not clear from stdout, check the logs located in <code>&lt;vcpkg root&gt;/buildtrees/&lt;port name&gt;/</code></p>
<h4 id="reinistallation-after-changes">Reinistallation after changes<a class="headerlink" href="#reinistallation-after-changes" title="Permanent link">&para;</a></h4>
<p>During testing, we can reach a scenario where a) we successfully installed the port, b) we need to make some changes. In this case, we need to reinstall the port. However, it is not completely straightforward due to <a href="https://learn.microsoft.com/en-us/vcpkg/consume/binary-caching-default">binary caching</a>. The following steps are needed to reinstall the port:</p>
<ol>
<li>uninstall the port: <code>vcpkg remove &lt;port name&gt;</code></li>
<li>disable the binary cache by setting the <a href="https://learn.microsoft.com/en-us/vcpkg/reference/binarycaching"><code>VCPKG_BINARY_SOURCES</code></a> environment variable to <code>clear</code><ul>
<li>in PowerShell: <code>$env:VCPKG_BINARY_SOURCES = "clear"</code></li>
<li>in bash: <code>export VCPKG_BINARY_SOURCES=clear</code></li>
<li>if setting the environment variable does not work (WSL), we can specify the <code>--binarysource=clear</code> option in the next step</li>
</ul>
</li>
<li>install the port again: <code>vcpkg install &lt;port name&gt;</code></li>
</ol>
<h4 id="executable-installation">Executable installation<a class="headerlink" href="#executable-installation" title="Permanent link">&para;</a></h4>
<p>In general vcpgk does not allow to install executables, as it is a dependency manager rather than a package manager for OS. However, it is possible to install executables that are intedned to be used as tools (to the <code>installed/&lt;triplet&gt;/tools</code> directory) used in the build process. To do so, you have to add the <a href="https://learn.microsoft.com/en-us/vcpkg/maintainers/functions/vcpkg_copy_tools"><code>vcpgk_copy_tools</code></a> call to the <code>portfile.cmake</code> file:</p>
<pre><code class="language-cmake">vcpkg_copy_tools(
    TOOL_NAMES &lt;tool target name&gt;
    AUTO_CLEAN
)
</code></pre>
<p>The <code>AUTO_CLEAN</code> option ensures that the tools are deleted from the <code>bin</code> directory. Without it the tools will be kept in the <code>bin</code> directory, resulting in warnings and non-complicance with the vcpkg rules.</p>
<p>The <code>vcpgk_copy_tools</code> function also automatically copies the runtime dependencies of the tools to the <code>tools</code> directory. </p>
<h4 id="executing-installed-tools-from-cmake">Executing installed tools from cmake<a class="headerlink" href="#executing-installed-tools-from-cmake" title="Permanent link">&para;</a></h4>
<p>The installed tools can be executed from cmake using cmake comands specified in the <a href="../CMake%20Manual/#executing-external-commands">CMake manual</a>. </p>
<p>To specify the path to the tools directory, use the <a href="https://learn.microsoft.com/en-us/vcpkg/users/buildsystems/cmake-integration#vcpkg_installed_dir"><code>VCPKG_INSTALLED_DIR</code></a> and <a href="https://learn.microsoft.com/en-us/vcpkg/users/buildsystems/cmake-integration#vcpkg_target_triplet"><code>VCPKG_TARGET_TRIPLET</code></a> variables:</p>
<pre><code class="language-cmake">execute_process(
    COMMAND ${VCPKG_INSTALLED_DIR}/${VCPKG_TARGET_TRIPLET}/tools/${PROJECT_NAME}/&lt;tool name&gt;
)
</code></pre>
<h3 id="publishing">Publishing<a class="headerlink" href="#publishing" title="Permanent link">&para;</a></h3>
<p><a href="https://learn.microsoft.com/en-us/vcpkg/get_started/get-started-adding-to-registry">official guide</a></p>
<p>Before publishing the port, we should check for the following:</p>
<ul>
<li>all dependencies in <code>CMakelists.txt</code> are required (<code>find_package(&lt;package name&gt; REQUIRED)</code>) <strong>and</strong> listed in the <code>vcpkg.json</code> file in the <code>dependencies</code> array</li>
<li>the port follows the <a href="https://github.com/microsoft/vcpkg-docs/blob/main/vcpkg/contributing/maintainer-guide.md">maintainer guide</a>, especially:<ul>
<li>the port name does not clash with existing packages (check at <a href="https://repology.org/">repology</a>)</li>
<li>the port should work for both Windows and Linux and on both platforms, the port should support both static and dynamic linking.</li>
</ul>
</li>
<li>the <a href="https://learn.microsoft.com/en-us/vcpkg/contributing/pr-review-checklist">PR checklist</a> is followed</li>
</ul>
<p>Then, the submission process is as follows (The <em>emphezised</em> steps are not needed in case of fixing a failed release, i.e., when the release was rejected by vcpkg):</p>
<ol>
<li><em>create a fork of the vcpkg repository</em></li>
<li>commit and push the changes to the project repository if not done yet</li>
<li>create or replace a release in the projects GitHub repository</li>
<li>update the verison in the <code>vcpkg_from_github</code> call in <code>portfile.cmake</code></li>
<li>update the version in the <code>vcpkg.json</code> file</li>
<li>pull from the vcpgk fork repository</li>
<li>copy the port (<code>portfile.cmake</code>, <code>vcpkg.json</code> and <code>usage</code>) to the vcpkg repository</li>
<li>remove the local <code>SOURCE_PATH</code> overrides and uncomment the <code>vcpkg_from_github</code> call</li>
<li>in portfile, assign the correct hash to the <code>vcpkg_from_github</code> call</li>
<li>test the port installation locally without the <code>--overlay-ports</code> option</li>
<li>format the <code>vcpkg.json</code> file using the <code>vcpkg format-manifest &lt;path to the vcpkg.json file&gt;</code> command</li>
<li><em>create a new branch for the package</em></li>
<li>commit the changes to the package branch in the vcpkg repository</li>
<li>update the port version using the <code>vcpkg x-add-version &lt;port name&gt;</code> command</li>
<li>commit again to the package branch in the vcpkg repository</li>
<li>push the branch to the forked vcpkg repository</li>
<li><em>open the forked repository in the browser and create a new pull request to the main vcpkg repository</em></li>
</ol>
<h1 id="ide">IDE<a class="headerlink" href="#ide" title="Permanent link">&para;</a></h1>
<h2 id="clion">Clion<a class="headerlink" href="#clion" title="Permanent link">&para;</a></h2>
<h3 id="configuration">Configuration<a class="headerlink" href="#configuration" title="Permanent link">&para;</a></h3>
<h4 id="set-default-layout">Set default layout<a class="headerlink" href="#set-default-layout" title="Permanent link">&para;</a></h4>
<p><code>Window</code> -&gt; <code>Layouts</code> -&gt; <code>Save changes in current layout</code></p>
<h4 id="set-up-the-new-nova-engine">Set up the new Nova engine<a class="headerlink" href="#set-up-the-new-nova-engine" title="Permanent link">&para;</a></h4>
<p>The new Nova engine is a new Clion's engine that is faster and have more features. It is the engine that is used in Visual Studio Resharper C++ plugin. To enable it, go to <code>settings</code> -&gt; <code>Advanced Settings</code> and under <code>Clion</code> check the <code>Use the ReSharper C++ language engine (Clion Nova)</code>.</p>
<p>Apart from the new features, the Nova engine can prevent some false errors that are caused by the clangd engine used by the old Clion engine.</p>
<h4 id="set-up-new-surround-with-template">Set up new surround with template<a class="headerlink" href="#set-up-new-surround-with-template" title="Permanent link">&para;</a></h4>
<p>In Clion, there are two types of surround with templates: <code>surrond with</code> and <code>surround with live template</code>. The first type use simple predefined templates and cannot be modified. However, the second type can be modified and new templates can be added. </p>
<h3 id="toolchain-configuration">Toolchain configuration<a class="headerlink" href="#toolchain-configuration" title="Permanent link">&para;</a></h3>
<p>Go to <code>settings</code> -&gt; <code>Build, Execution, Deployment</code> -&gt; <code>toolchain</code>, add new toolchain and set:</p>
<ul>
<li>Name to whatever you want</li>
<li>The environment should point to your toolchain:<ul>
<li>MSVC: <code>C:\Program Files (x86)\Microsoft Visual Studio\2019\Community</code></li>
<li>MSYS: <code>C:\MSYS2</code> </li>
<li>WSL: From the drop-down list, choose the environment you configured for using with CLion in the previous steps</li>
</ul>
</li>
<li>Credentials (WSL) click to the setting button next to the credentials and fill<ul>
<li>host: <code>localhost</code></li>
<li>port: <code>2222</code></li>
<li>user and password according to your WSL system credentials</li>
</ul>
</li>
<li>Architecture (non WSL): amd64</li>
<li>CMake: <code>C:\Program Files\CMake\bin\cmake.exe</code>, for WSL, leave it as it is</li>
<li>other fields should be filled automatically</li>
</ul>
<h4 id="multiple-wsl-toolchains">Multiple WSL toolchains<a class="headerlink" href="#multiple-wsl-toolchains" title="Permanent link">&para;</a></h4>
<p>When using multiple WSL toolchains, we need to manually set the compilers. To do so, fill also the <code>C Compiler</code> and <code>C++ Compiler</code> fields in the toolchain settings with the path to the compiler executable.</p>
<h3 id="project-configuration">Project configuration<a class="headerlink" href="#project-configuration" title="Permanent link">&para;</a></h3>
<p>Most project settings resides (hereinafter <em>Project settings</em>) in <code>settings</code> -&gt; <code>Build, Execution, Deployment</code> -&gt; <code>CMake</code>. For each build configuration, add a new template and set:</p>
<ul>
<li><code>Name</code> to whatever you want   </li>
<li><code>Build type</code> to <code>debug</code></li>
<li>To <code>Cmake options</code>, add:<ul>
<li>path to vcpkg toolchain file:<ul>
<li>Linux: <code>-DCMAKE_TOOLCHAIN_FILE=/opt/vcpkg/scripts/buildsystems/vcpkg.cmake</code></li>
<li>Windows: <code>-DCMAKE_TOOLCHAIN_FILE=C:/vcpkg/scripts/buildsystems/vcpkg.cmake</code></li>
</ul>
</li>
<li>Set the correct vcpkg triplet<ul>
<li>MSVC:   <code>-DVCPKG_TARGET_TRIPLET=x64-windows</code></li>
<li>MinGW:  <code>-DVCPKG_TARGET_TRIPLET=x64-MinGW</code></li>
<li>Linux: <code>-DVCPKG_TARGET_TRIPLET=x64-linux</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="wsl-extra-configuration">WSL extra configuration<a class="headerlink" href="#wsl-extra-configuration" title="Permanent link">&para;</a></h4>
<p>The CLion does not see the WSL's environment variables (as of 2023-03, see <a href="https://intellij-support.jetbrains.com/hc/en-us/community/posts/5633934229906-Programs-cannot-get-environment-variables-from-wsl">here</a>). To fix it, go to <em>Project settings</em> and set add the necessary environment variables to <code>Environment</code> field. </p>
<h4 id="configuring-only-some-cmake-profiles">Configuring only some CMake profiles<a class="headerlink" href="#configuring-only-some-cmake-profiles" title="Permanent link">&para;</a></h4>
<p>When we click on the CMake reconiguration button, all profiles are reconfigured. Unfortunately, there is no way how to configure only some profiles. To work around this, we can deactivate the profiles we do not want to configure. To do so:</p>
<ol>
<li>go to <code>settings</code> -&gt; <code>Build, Execution, Deployment</code> -&gt; <code>CMake</code> </li>
<li>select the profile you want to deactivate</li>
<li>uncheck the <code>Enable profile</code> checkbox located at the top of the profile settings</li>
</ol>
<h3 id="problems">Problems<a class="headerlink" href="#problems" title="Permanent link">&para;</a></h3>
<h4 id="editor-reports-errors-despite-the-code-compiles-in-all-compilers">Editor reports errors despite the code compiles in all compilers<a class="headerlink" href="#editor-reports-errors-despite-the-code-compiles-in-all-compilers" title="Permanent link">&para;</a></h4>
<p>This can be caused by the clangd engine used by the old Clion engine. To fix it, enable the new Nova engine.</p>
<h2 id="visual-studio">Visual Studio<a class="headerlink" href="#visual-studio" title="Permanent link">&para;</a></h2>
<h3 id="installation_2">Installation<a class="headerlink" href="#installation_2" title="Permanent link">&para;</a></h3>
<ol>
<li>Install Visual Studio</li>
<li>Open/Create a CMake project</li>
<li>Install ReSharper C++</li>
</ol>
<h3 id="setting-synchronization">Setting Synchronization<a class="headerlink" href="#setting-synchronization" title="Permanent link">&para;</a></h3>
<ol>
<li>Sign-in in Visual Studio using a Mictosoft account. <a href="https://docs.microsoft.com/en-us/visualstudio/ide/synchronized-settings-in-visual-studio?view=vs-2022">A lot of settings should be synchronized automatically</a>.</li>
<li>Apply the layout: <code>Window</code> -&gt; <code>Apply Window Layout</code> -&gt; <code>&lt;Layout Name&gt;</code></li>
<li>Sync ReSharper settings: you can share the file: <code>%APPDATA%\JetBrains\Shared\vAny\</code> (<code>~\AppData\Roaming\JetBrains\Shared\vAny\</code>). <ul>
<li>This does not work good though as the files are changed on both sides constantly.</li>
<li>unfortunately, as of 01/2023, there is no good way how to share resharper settings</li>
</ul>
</li>
<li>Install roamed plugins</li>
</ol>
<h3 id="basic-configuration">Basic Configuration<a class="headerlink" href="#basic-configuration" title="Permanent link">&para;</a></h3>
<ol>
<li><a href="https://marketplace.visualstudio.com/items?itemName=PaulHarrington.EditorGuidelines">Add 120 char guideline</a><ul>
<li>install the extension </li>
<li>add the guideline in command window: <code>Edit.AddGuideline 120</code></li>
<li>if there is an error <em>extension ... did not load properly</em>, you need to install the <em>developer analytic tools</em> package to the Visual Studio:<ul>
<li>Visual Studio Installer -&gt; <code>modify</code></li>
<li>Go to the <code>Individual Components</code> tab</li>
<li>search for the extension and select it</li>
<li>proceed with the Visual Studio Modification</li>
</ul>
</li>
</ul>
</li>
<li>If you need to use the system CMake, configure it now (described below)</li>
<li>If you use <code>*.tpp</code> file, configure a support for them (described below).</li>
</ol>
<p>installation</p>
<h4 id="enable-template-implementation-files-tpp-syntax-highlighting">Enable template implementation files (<code>.*tpp</code>) syntax highlighting:<a class="headerlink" href="#enable-template-implementation-files-tpp-syntax-highlighting" title="Permanent link">&para;</a></h4>
<ul>
<li>Go to <code>Tools</code> -&gt; <code>Options</code> -&gt; <code>Text Editor</code> -&gt; <code>File Extension</code></li>
<li>select Microsoft Visual C++</li>
<li>write <code>tpp</code> to the field and click add</li>
<li>(reopen the file to see changes)</li>
</ul>
<h4 id="to-change-the-build-verbosity">To Change the Build Verbosity<a class="headerlink" href="#to-change-the-build-verbosity" title="Permanent link">&para;</a></h4>
<ol>
<li>Go to <code>Tools</code> -&gt; <code>Options</code> -&gt; <code>Projects and Solutions</code> -&gt; <code>Build and Run</code></li>
<li>Change the value of the MSBuild project build output verbosity.</li>
</ol>
<h3 id="project-setting">Project Setting<a class="headerlink" href="#project-setting" title="Permanent link">&para;</a></h3>
<h4 id="configure-visual-studio-to-use-system-cmake">Configure Visual Studio to use system CMake:<a class="headerlink" href="#configure-visual-studio-to-use-system-cmake" title="Permanent link">&para;</a></h4>
<ul>
<li>Go to <code>Project</code> -&gt; <code>CMake Settings</code></li>
<li>it should open the <code>CMakeSettings.json</code> file</li>
<li>Scroll to the bottom and click on <code>show advanced settings</code> </li>
<li>Set the CMake executable to point to the <code>cmake.exe</code> file of your system CMake </li>
</ul>
<h4 id="build-setting-and-enviromental-variables">Build Setting and Enviromental Variables<a class="headerlink" href="#build-setting-and-enviromental-variables" title="Permanent link">&para;</a></h4>
<p>The build configuration is in the file <code>CMakePresets.json</code>, located in the root of the project. The  file can be also opened by right clicking on <code>CMakeLists.txt</code> ad selecting <code>Edit CMake presets</code>.</p>
<h5 id="set-the-cmake-toolchain-file">Set the CMake Toolchain File<a class="headerlink" href="#set-the-cmake-toolchain-file" title="Permanent link">&para;</a></h5>
<p>To set the vcpkg toolchain file add the following value to the base configuration <code>cacheVariables</code> dictionary:</p>
<pre><code class="language-json">&quot;CMAKE_TOOLCHAIN_FILE&quot;: {
    &quot;value&quot;: &quot;C:/vcpkg/scripts/buildsystems/vcpkg.cmake&quot;,
    &quot;type&quot;: &quot;FILEPATH&quot;
}
</code></pre>
<h5 id="set-the-compiler">Set the Compiler<a class="headerlink" href="#set-the-compiler" title="Permanent link">&para;</a></h5>
<p>The MSVC toolchain has two compiler executables, default one, and clang. The default compiler configuration looks like this:</p>
<pre><code class="language-json">&quot;cacheVariables&quot;: {
    ...
    &quot;CMAKE_C_COMPILER&quot;: &quot;cl.exe&quot;,
    &quot;CMAKE_CXX_COMPILER&quot;: &quot;cl.exe&quot;
    ...
},
</code></pre>
<p>To change the compiler to clang, replace <code>cl.exe</code> by <code>clang-cl.exe</code> in both rows.</p>
<h5 id="old-method-using-cmakesettingsjson">Old Method Using CMakeSettings.json<a class="headerlink" href="#old-method-using-cmakesettingsjson" title="Permanent link">&para;</a></h5>
<p>We can open the build setting by right click on <code>CMakeList.txt</code> -&gt; <code>Cmake Settings</code></p>
<p>To configure configure vcpkg toolchain file: Under <code>General</code>, fill to the <code>Cmake toolchain file</code> the following: <code>C:/vcpkg/scripts/buildsystems/vcpkg.cmake</code></p>
<p>To configure the enviromental variable, edit the <code>CmakeSettings.json</code> file directly. The global variables can be set in the <code>environments</code> array, the per configuration ones in <code>&lt;config object&gt;/environments</code> (<a href="https://devblogs.microsoft.com/cppblog/set-environment-variables-for-debug-launch-and-tools-with-cmake-and-open-folder/">exmaple</a>).</p>
<h4 id="launch-setting">Launch Setting<a class="headerlink" href="#launch-setting" title="Permanent link">&para;</a></h4>
<p>The launch settings determins the launch configuration, most importantly, the run arguments. To modify the run arguments:
 1. open the <code>launch.vs.json</code> file:
    - use the context menu:
            -   Right-click on <code>CMakeLists.txt</code> -&gt; <code>Add Debug Configuration</code>
            -   select <code>default</code>
    - or open the file directly, it is stored in <code>&lt;PROJECT DIR&gt;/.vs/</code>
2.   in <code>launch.vs.json</code> configure:
        - <code>type</code>: <code>default</code> for MSVC or <code>cppgdb</code> for WSL
        - <code>projectTarget</code>: the name of the target (executable)
        - <code>name</code>: the display name in Visual Studio
        - <code>args</code>: json array with arguments as strings
            - arguments with spaces have to be quoted with escaped quotes
3.  Select the launch configuration in the drop-down menu next to the play button</p>
<p>If the configuration is not visible in the drop-down menu, double-check the <code>launch.vs.json</code> file. The file is not validated, so it is easy to make a typo. If there is any problem, insted of an error, the launch configuration is not available. The following problems are common:</p>
<ul>
<li>syntax error in the json (should be marked by red squiggly line)</li>
<li>typo in the target name</li>
</ul>
<h5 id="other-launchvsjson-options">Other launch.vs.json options<a class="headerlink" href="#other-launchvsjson-options" title="Permanent link">&para;</a></h5>
<ul>
<li><code>cwd</code>: the working directory</li>
</ul>
<p><a href="https://learn.microsoft.com/en-us/cpp/build/launch-vs-schema-reference-cpp?view=msvc-170">Microsoft reference for <code>launch.vs.json</code></a></p>
<h3 id="wsl-configuration">WSL Configuration<a class="headerlink" href="#wsl-configuration" title="Permanent link">&para;</a></h3>
<p>For using GCC 10:</p>
<ul>
<li>go to <code>CmakeSettings.json</code> -&gt; <code>CMake variables and cache</code></li>
<li>select <code>show advanced variables checkbox</code></li>
<li>set <code>CMAKE_CXX_COMPILER</code> variable to <code>/usr/bin/g++-10</code></li>
</ul>
<h3 id="other-configuration">Other Configuration<a class="headerlink" href="#other-configuration" title="Permanent link">&para;</a></h3>
<ul>
<li>show white spaces: <code>Edit</code> -&gt; <code>Advanced</code> -&gt; <code>View White Space</code>.</li>
<li>configure indentation: described <a href="https://docs.microsoft.com/en-us/visualstudio/ide/reference/options-text-editor-all-languages-tabs?view=vs-2022">here</a></li>
</ul>
<h3 id="determine-visual-studio-version">Determine Visual Studio version<a class="headerlink" href="#determine-visual-studio-version" title="Permanent link">&para;</a></h3>
<p>At total, <a href="https://blog.knatten.org/2022/08/26/microsoft-c-versions-explained/">there are 5 different versionigs related to Visual Studio</a>. </p>
<p>The version which the <a href="https://en.cppreference.com/w/cpp/compiler_support">compiler support table</a> refers to is the version of the compiler (<code>cl.exe</code>).
we can find it be examining the compiler executable stored in <code>C:\Program Files\Microsoft Visual Studio\2022\Community\VC\Tools\MSVC\14.34.31933\bin\Hostx64\x64</code>.</p>
<h3 id="problems-solutions">Problems &amp; solutions<a class="headerlink" href="#problems-solutions" title="Permanent link">&para;</a></h3>
<h4 id="cannot-regenerate-cmake-cache">Cannot regenerate Cmake cache<a class="headerlink" href="#cannot-regenerate-cmake-cache" title="Permanent link">&para;</a></h4>
<p>go to <code>./vs</code> and look for file named <code>CmakeWorkspaceSettings</code>. It most likelz contains a line with <code>disable = true</code>. Just delete the file, or the specific line.</p>
<h1 id="typical-directory-structure">Typical directory structure<a class="headerlink" href="#typical-directory-structure" title="Permanent link">&para;</a></h1>
<p>The typical directory structure for a C++ project is as follows:</p>
<ul>
<li><code>data</code>: the directory containing the data files, including test data and default configuration files</li>
<li><code>include</code>: the directory containing public header files<ul>
<li>this directory is for the headers that are meant to be included by other projects. Typically, only library projects have this directory</li>
<li>the projects own headers should be in the <code>include/&lt;project name&gt;</code> directory to mimic the installation directory structure</li>
</ul>
</li>
<li><code>install</code>: the directory containing the installation scripts. Only needed for library projects or projects that are meant to be distributed</li>
<li><code>port</code>: the directory containing the vcpkg port files. Only needed for libraries that are meant to be distributed via vcpkg</li>
<li><code>src</code>: the directory containing the source files and private headers</li>
<li><code>test</code>: the directory containing the test files</li>
<li><code>&lt;various build dirs&gt;</code>: the directories containing the build files.</li>
</ul>
<p>The root directory typically contains the following files:</p>
<ul>
<li><code>.gitignore</code>: the git ignore file</li>
<li><code>CMakeLists.txt</code>: the main cmake file</li>
<li><code>CTestConfig.cmake</code>: the CTest configuration file</li>
</ul>
<h1 id="dependencies">Dependencies<a class="headerlink" href="#dependencies" title="Permanent link">&para;</a></h1>
<p>Unlike in Python and Java, that have pip and maven, C++ does not have a standard package manager. Instead, there are plenty of ways how to install the dependencies and CMake then tries to find them. In the following table, we list the most common ways how to install the dependencies together with theri pros and cons.</p>
<table>
<thead>
<tr>
<th>Method</th>
<th>Platform-independent</th>
<th>Automatic install of the dependency tree</th>
<th>Can install build configuration tools</th>
<th>Support easily determined</th>
</tr>
</thead>
<tbody>
<tr>
<td>CMake <code>--install</code></td>
<td>yes</td>
<td>no</td>
<td>yes</td>
<td>no</td>
</tr>
<tr>
<td>vcpkg</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
</tr>
<tr>
<td>CMake <code>FetchContent</code></td>
<td>yes</td>
<td>no</td>
<td>no</td>
<td>no</td>
</tr>
<tr>
<td>CMake <code>ExternalProject</code></td>
<td>yes</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="vcpkg-libraries">Vcpkg Libraries<a class="headerlink" href="#vcpkg-libraries" title="Permanent link">&para;</a></h2>
<ol>
<li>type <code>vcpkg list</code>, if the library you need is not listed, continue to the next steps</li>
<li>type <code>vcpkg search &lt;library simple name&gt;</code> and inspect the result to determine the exact name of the package you need<ul>
<li>if the library is not listed, check the presence in <a href="https://repology.org/projects/?inrepo=vcpkg">vcpkg repo</a></li>
<li>if the library is in repo, but search does not find it, <a href="#update">update vcpkg</a></li>
</ul>
</li>
<li>type <code>vcpkg install &lt;exact name&gt;</code> to install the package</li>
<li>at the end of the installation log, there will be a cmake command needed to integrate the library, put it to the appropriate place to your <code>CMakeList.txt file</code></li>
</ol>
<p>To display the cmake commands for the installed libraries, just run <code>vcpkg install &lt;exact name&gt;</code> again.</p>
<h3 id="boost">Boost<a class="headerlink" href="#boost" title="Permanent link">&para;</a></h3>
<p>With boost, we should install only the necessary components. Then to include boost, we need:</p>
<ul>
<li><code>find_package(Boost REQUIRED)</code><ul>
<li>with all compiled components listed</li>
</ul>
</li>
<li><code>target_include_directories(&lt;YOUR TARGET NAME&gt; PUBLIC ${Boost_INCLUDE_DIRS})</code></li>
</ul>
<p>Sometimes, it may be usefull to find out which boost components require linking. The list in the boost documentation, both for <a href="https://www.boost.org/doc/libs/1_85_0/more/getting_started/unix-variants.html#header-only-libraries">Unix</a> and <a href="https://www.boost.org/doc/libs/1_85_0/more/getting_started/windows.html#header-only-libraries">Windows</a>.</p>
<h3 id="jni">JNI<a class="headerlink" href="#jni" title="Permanent link">&para;</a></h3>
<p>for JNI, a <code>JAVA_HOME</code> system property needs to be set to the absolute path to the JDK, e.g., <code>C:\Program Files\Java\jdk-15.0.1</code></p>
<h2 id="gurobi">Gurobi<a class="headerlink" href="#gurobi" title="Permanent link">&para;</a></h2>
<ol>
<li>If you don’t have Gurobi installed, do it now, and check that the installation is working<ul>
<li>Windows: just install as usual  </li>
<li>Linux:<ol>
<li>download the archive to <code>/opt</code></li>
<li><code>sudo tar xvfz &lt;gurobi archive&gt;</code></li>
<li>add the the <a href="https://drive.google.com/file/d/1Vr5VReq2_rOMNm4bsC7HJ9xELeiKeiTR/view?usp=sharing">file that introduce environment variables needed for gurobi</a> to <code>etc/profile.d</code></li>
</ol>
</li>
</ul>
</li>
<li><strong>Linux only:</strong> it is necessary to build the C++ library for your version of the compiler. Steps:
        1. <code>cd &lt;GUROBI DIR&gt;/linux64/src/build/</code>
        2. <code>make</code>
        3.  <code>mv libgurobi_c++.a ../../lib/libgurobi_c++_&lt;some id for you, like version&gt;.a</code>
        4.  <code>cd ../../lib/</code>
        5.  <code>ln -sf ./libgurobi_c++&lt;some id for you, like version&gt;.a libgurobi_c++.a</code></li>
<li>Follow <a href="https://support.gurobi.com/hc/en-us/articles/360039499751-CMake-C-C-compilation-of-Gurobi-projects">this guide</a>, specifically:
        1.   put the attached  <a href="https://drive.google.com/file/d/1h9JovBfjxnnQKLjBPIjSfQQpmEhn3VKC/view?usp=sharing">our custom FindGUROBI script</a> to: 
             - Windows: <code>C:\Program Files\CMake\share\cmake-&lt;your cmake
   version&gt;\Modules/</code>
             - Linux: <code>/opt/&lt;CMAKNAME&gt;/share/cmake-&lt;VERSION&gt;/Modules</code>
        2.   to your <code>CMakeLists.txt</code>, add:
                -   <code>find_package(GUROBI REQUIRED)</code>
                -   <code>target_include_directories(&lt;your executable&gt; PRIVATE ${GUROBI_INCLUDE_DIRS})</code>
                -   <code>target_link_libraries(&lt;your executable&gt; PRIVATE ${GUROBI_LIBRARY})</code>
                -   <code>target_link_libraries(&lt;your executable&gt; PRIVATE optimized ${GUROBI_CXX_LIBRARY} debug ${GUROBI_CXX_DEBUG_LIBRARY})</code>
        3.   try to load the cmake projects (i.e., generate the build scripts using cmake).
        4.   if the C++ library is not found (<code>Gurobi c++ library not found</code>), check whether the correct C++ library is in the gurobi home, the file <code>&lt;library name&gt;.lib</code> has to be in the <code>lib</code> directory of the gurobi installation. If the file is not there, it is possible that your gurobi version is too old</li>
</ol>
<h3 id="update-gurobi">Update Gurobi<a class="headerlink" href="#update-gurobi" title="Permanent link">&para;</a></h3>
<ul>
<li>Updating is done by <a href="https://www.gurobi.com/downloads/gurobi-software/">installing the new version</a> and generating and using <a href="https://www.gurobi.com/downloads/end-user-license-agreement-academic/">new licence key</a>.</li>
<li>after update, you need to delete your build dir in order to prevent using of cached path to old Gurobi install</li>
<li>Also, you need to update the library name on line 10 of the <code>FindGUROBI.cmake</code> script.</li>
</ul>
<h2 id="other-libraries-not-available-in-vcpkg">Other Libraries Not Available in vcpkg<a class="headerlink" href="#other-libraries-not-available-in-vcpkg" title="Permanent link">&para;</a></h2>
<h3 id="test-library-linkinginclusion">Test Library linking/inclusion<a class="headerlink" href="#test-library-linkinginclusion" title="Permanent link">&para;</a></h3>
<p>For testing purposes, we can follow this simple pattern:</p>
<ol>
<li>build the library</li>
<li>include the library: <code>target_include_directories(&lt;target name&gt; PUBLIC &lt;path to include dir&gt;)</code>, where include dir is the directory with the main header file of the library.</li>
<li>if the library is not the header only library, we need to:
    3.1  link the library: <code>target_link_libraries(&lt;target name&gt; PUBLIC &lt;path to lib file&gt;)</code>, where path to lib file is the path to the dynamic library file used for linking (<code>.so</code> on Linux, <code>.lib</code> on Windows).
    3.2. add the dynamic library to some path visible for the executable
        - here the library file is <code>.so</code> on Linux and <code>.dll</code> on Windows
        - there are plenty options for the visible path, the most common being the system <code>PATH</code> variable, or the directory with the executable. </li>
</ol>
<h2 id="dependencies-with-wsl-and-clion">Dependencies with WSL and CLion<a class="headerlink" href="#dependencies-with-wsl-and-clion" title="Permanent link">&para;</a></h2>
<p>In WSL, when combined with CLion, some find scripts does not work, because they depend on system variables, that are not correctly passed from CLIon SSH connection to CMake. Therefore, it is necessary to add hints with absolute path to these scripts. Some of them can be downloaded <a href="https://drive.google.com/drive/folders/1rWVl_T3p0cIf6QBYFtc-sEfuA-TUs2CU?usp=sharing">here</a>. Package that require these hints:</p>
<ul>
<li>JNI</li>
<li>Gurobi</li>
</ul>
<h1 id="refactoring">Refactoring<a class="headerlink" href="#refactoring" title="Permanent link">&para;</a></h1>
<p>The refactoring of C++ code is a complex process, so the number of supported refactoring operations is limited. In Visual Studio, the only supported refactoring operation is renaming. In IntelliJ tools (CLion, ReSharper C++), there are more tools available, but still, the refactoring is not as powerful nor reliable as in Java or Python.</p>
<p>Other alternative is to implement the refactoring manually, with a help of some compiler tools like <a href="https://clang.llvm.org/docs/RefactoringEngine.html">clang Refactoring Engine</a> (<a href="https://github.com/realincubus/clang-refactor">example project</a>). </p>
<h2 id="changing-method-signature">Changing Method Signature<a class="headerlink" href="#changing-method-signature" title="Permanent link">&para;</a></h2>
<p>As of 2023-10, there is no reliable way how to change the method signature in C++. The most efficient tool is the method signature refactorin in either CLion or ReSharper C++. However, it does not work in all cases, so it is necessary to check and fix the code manually.</p>
<h1 id="standard-library">Standard Library<a class="headerlink" href="#standard-library" title="Permanent link">&para;</a></h1>
<p>The strucure and organization of the <a href="https://en.wikipedia.org/wiki/C%2B%2B_Standard_Library">standard library</a> is different on Windows and Linux.</p>
<p>On <strong>Windows</strong> (specificly when using MSVC) the library is called MSVC C Runtime (CRT). It is divided between:</p>
<ul>
<li><code>VCRuntime&lt;version&gt;.dll</code>: contains the parts that interacts with the OS<ul>
<li>new versions are released with new versions of Visual Studio</li>
</ul>
</li>
<li><code>ucrtbase.dll</code>: contains other parts of the CRT<ul>
<li>non-versioned, the same for all versions of Visual Studio</li>
</ul>
</li>
<li>many other libraries</li>
</ul>
<p>On <strong>Linux</strong>, the library is divided between C and C++ standard libraries:</p>
<ul>
<li>C++ Standard Library: contains the standard C++ features described in the C++ standard.<ul>
<li>GNU: <code>libstdc++</code></li>
<li>LLVM: <code>libc++</code></li>
</ul>
</li>
<li><a href="https://en.wikipedia.org/wiki/Glibc">C Standard Library (<code>glibc</code>)</a>: contains the standard C features described in the C standard.<ul>
<li>To get the version, run <code>ldd --version</code></li>
</ul>
</li>
</ul>
<h2 id="linking-to-the-standard-library">Linking to the Standard Library<a class="headerlink" href="#linking-to-the-standard-library" title="Permanent link">&para;</a></h2>
<p>On both platforms:</p>
<ul>
<li>the standard library is linked automatically</li>
<li>the standard library is linked dynamically by default</li>
</ul>
<p>However, Windows and Linux have different attitudes towards static linking of the standard library:</p>
<ul>
<li><strong>Windows</strong>: static linking is pretty common and easy to setup:<ul>
<li>pros: easy way to distribute the application to older systems, possibly decades old</li>
<li>cons: even begginers have to check that the executable and all its dependencies link to the same (static vs dynamic) version of the CRT</li>
</ul>
</li>
<li><strong>Linux</strong>: static linking is not common and not recommended:<ul>
<li>pros: the mismatch of the standard library linking between the executable and the dependencies is not a problem</li>
<li>cons: the executable is typically not portable to other systems, unless the same version of the standard library is installed (<code>glibc</code> is usually stable, but <code>libstdc++</code> and <code>libc++</code> are not)</li>
</ul>
</li>
</ul>
<h3 id="setting-up-the-correct-crt-with-msvc">Setting up the correct CRT with MSVC<a class="headerlink" href="#setting-up-the-correct-crt-with-msvc" title="Permanent link">&para;</a></h3>
<p><a href="https://learn.microsoft.com/en-us/cpp/build/reference/md-mt-ld-use-run-time-library">official documentation</a></p>
<p>It is critical to set the runtime library for the executable we are building so that it matches the runtime library used by the dependencies. If the mismatch occurs, it is manifested depending on the situation:</p>
<ul>
<li>when we link to a dynamic CRT, but dependencies link to a static CRT, the linker will throw an error, typically for each such dependency
    <code>plaintext
    LNK2038 mismatch detected for 'RuntimeLibrary': value 'MDd_DynamicDebug' doesn't match value 'MTd_StaticDebug' in ..</code></li>
<li>when we link to a staticCRT, but dependencies link to a dynamic CRT, the linker proceeds without errors, but the program crashes at runtime. Typically, some allocation/deallocation error occurs.</li>
</ul>
<p>The CRT is set by compiler flags (see the table below). </p>
<ul>
<li>These flags are typically passed to the compiler by the build system based on the build configuration files (e.g., <code>MSBuild</code> files).</li>
<li>They affect all parts of the CRT</li>
</ul>
<p>If we generate thes files by the IDE (Visual Studio), we have to set the CRT in the IDE. If they are generated by <strong>CMake</strong>, there are three possible situations:</p>
<ul>
<li>we use the dynamic CRT (default): nothing has to be done</li>
<li>the build is handled by vcpkg (libraries installed with <code>vcpgk install</code>): the runtime library is set by the <a href="https://learn.microsoft.com/en-us/vcpkg/users/triplets#vcpkg_crt_linkage"><code>VCPKG_CRT_LINKAGE</code></a> variable in the triplet file. Nothing has to be done.</li>
<li>we use the static CRT: we have to set the <code>CMAKE_MSVC_RUNTIME_LIBRARY</code> variable in the <code>CMakeLists.txt</code> file. if we use vcpgk libraries, we should set it based on the triplet used:
    <code>cmake
    if (VCPKG_TARGET_TRIPLET MATCHES "-static")
        set(CMAKE_MSVC_RUNTIME_LIBRARY "MultiThreaded$&lt;$&lt;CONFIG:Debug&gt;:Debug&gt;")
    endif()</code></li>
</ul>
<p>To <strong>determine if the type of the runtime library used by the target</strong>, we can explore the build script for the target, For MSBuild, the runtime library is set by the <code>RuntimeLibrary</code> property. To <strong>determine the runtime library used by a library</strong>, we can use the <a href="https://docs.microsoft.com/en-us/cpp/build/reference/dumpbin-reference">dumpbin</a> tool.
This tool is part of the Visual Studio installation and can be run from the Developer Command Prompt or Developer PowerShell. The following command will display the runtime library used by the library:</p>
<pre><code class="language-bash">dumpbin /directives &lt;path to the library&gt;
</code></pre>
<p>The following <strong>compiler flags</strong> are available:</p>
<table>
<thead>
<tr>
<th>Option</th>
<th>Copiler flag</th>
<th>MSBuild name</th>
<th>Description</th>
<th>Linged library</th>
</tr>
</thead>
<tbody>
<tr>
<td>Multi-threaded Dynamic</td>
<td><code>/MD</code></td>
<td><code>MultiThreadedDLL</code></td>
<td>The default option. The application uses the dynamic version of the runtime library.</td>
<td><code>msvcrt.lib</code></td>
</tr>
<tr>
<td>Multi-threaded Dynamic Debug</td>
<td><code>/MDd</code></td>
<td><code>MultiThreadedDebugDLL</code></td>
<td>The debug version of the dynamic runtime library.</td>
<td><code>msvcrtd.lib</code></td>
</tr>
<tr>
<td>Multi-threaded Static</td>
<td><code>/MT</code></td>
<td><code>MultiThreaded</code></td>
<td>The application uses the static version of the runtime library.</td>
<td><code>libcmt.lib</code></td>
</tr>
<tr>
<td>Multi-threaded Static Debug</td>
<td><code>/MTd</code></td>
<td><code>MultiThreadedDebug</code></td>
<td>The debug version of the static runtime library.</td>
<td><code>libcmtd.lib</code></td>
</tr>
<tr>
<td>DLL</td>
<td><code>/LD</code></td>
<td></td>
<td>The application is compiled as a DLL.</td>
<td>-</td>
</tr>
<tr>
<td>DLL Debug</td>
<td><code>/LDd</code></td>
<td></td>
<td>The debug version of the DLL.</td>
<td>-</td>
</tr>
</tbody>
</table>
<p>By default, the <code>/MD</code>/<code>/MDd</code> flags are used depending on the build type.</p>
<h2 id="resouces">Resouces<a class="headerlink" href="#resouces" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Microsoft_Windows_library_files#CRT">MSVC CRT on Wikipedia</a></li>
<li><a href="https://devblogs.microsoft.com/cppblog/introducing-the-universal-crt/">CRT reorganization blogpost from 2015</a></li>
<li><a href="https://github.com/huangqinjin/ucrt">GitHub repo with the relesed CRT sources, useful information, and links</a></li>
</ul>
<h1 id="exporting-symbols-for-shared-libraries">Exporting symbols for shared libraries<a class="headerlink" href="#exporting-symbols-for-shared-libraries" title="Permanent link">&para;</a></h1>
<p>When creating a shared library, we have to specify which symbols are exported. These are the only symbols that can be directly used from the client code. This is done using special keywords. Because the keywords are different for different compilers, usually, some macros are used instead. Typically, these macros:</p>
<ul>
<li>use the correct keyword for the compiler</li>
<li>support disabling the keyword for building static libraries or executables</li>
</ul>
<p>The macros are typically defined in a dedicated header file called <em>export header</em>. This file is then included in every header file that defines a symbol that should be exported. </p>
<p>For the whole export machinery to work, we need to:</p>
<ul>
<li>create the export header file and include it in every header file that defines an exported symbol</li>
<li>mark the symbols that should be exported with the export macro</li>
<li>use CMake to supply the correct compiler flags used in the export header</li>
</ul>
<h2 id="creating-the-export-header">Creating the Export Header<a class="headerlink" href="#creating-the-export-header" title="Permanent link">&para;</a></h2>
<p>We can generate the export header file using the <a href="https://cmake.org/cmake/help/latest/module/GenerateExportHeader.html"><code>GenerateExportHeader</code></a> module. We can get it by the following code:</p>
<pre><code class="language-cmake">add_library(&lt;target name&gt; SHARED &lt;files&gt;)
generate_export_header(&lt;target name&gt;)
</code></pre>
<p>This will generate the export header file in the build directory. However, the export file is different for different compilers. Therefore, it is best to copy the file for each compiler and then merge the macros to create a universal export header file. Alternatively, we can use some proven export header file.</p>
<p>Finally, we can store the export header file in the source directory and include it in every header file that defines an exported symbol.</p>
<h2 id="marking-the-symbols">Marking the Symbols<a class="headerlink" href="#marking-the-symbols" title="Permanent link">&para;</a></h2>
<p>Usually, we mark the following symbols for export:</p>
<ul>
<li>classes: <code>class &lt;export macro&gt; MyClass{...}</code></li>
<li>functions: <code>&lt;export macro&gt; &lt;return type&gt; my_function(...)</code></li>
</ul>
<p>Other symbols does not have to be exported as they are automatically exported by the compiler:</p>
<ul>
<li>enums and enum classes</li>
<li>constants</li>
<li>templates</li>
</ul>
<p>Additionaly, only the symbols needed by external code should be exported. The exeption is when the the interface use templates. In this case, all symbols used by the template (but not the template itself) should be exported.</p>
<p>The <code>&lt;export macro&gt;</code> from the <code>GenerateExportHeader</code> is named <code>&lt;target name&gt;_EXPORT</code>, we can check the exact name in the export header file.</p>
<h2 id="cmake-configuration">CMake Configuration<a class="headerlink" href="#cmake-configuration" title="Permanent link">&para;</a></h2>
<p>Now the shared library build should work correctly. However, the static library build will be full of warnings, because the export macro is not intended for static libraries. The same is true for executables. Therefore, we need to set a special property for each target that uses the export header and is not a shared library:</p>
<pre><code class="language-cmake">target_compile_definitions(&lt;static/executable target name&gt; PUBLIC &lt;static condition macro &gt;)
</code></pre>
<p>The static condition macro from the <code>GenerateExportHeader</code> is named <code>&lt;target name&gt;_STATIC_DEFINE</code>. If not clear, we can find the exact macros' names in the export header file.</p>
<h2 id="resouces_1">Resouces<a class="headerlink" href="#resouces_1" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="https://decovar.dev/blog/2021/03/08/cmake-cpp-library/">tutorial on decovar</a></li>
</ul>
<h1 id="compilation-for-a-specific-cpu">Compilation for a specific CPU<a class="headerlink" href="#compilation-for-a-specific-cpu" title="Permanent link">&para;</a></h1>
<h2 id="msvc">MSVC<a class="headerlink" href="#msvc" title="Permanent link">&para;</a></h2>
<p>MSVC cannot compile for a specific CPU or CPU series. It can, however, use new instructions sets more efficiently if it compiles the code without the support for CPUs thad does not support these instruction sets.</p>
<p>The command for the compiler is: `/arch:<set name> (see <a href="https://learn.microsoft.com/en-us/cpp/build/reference/arch-x64?view=msvc-170">MSVC documentation</a> for details).</p>
<p>## GCC
 In GCC, the <a href="https://gcc.gnu.org/onlinedocs/gcc/x86-Options.html"><code>march</code></a> option enables compilation for a specific hardware.
ml) option enables compilation for a specific hardware.</p>
<p>pects that you use vcpkg in a per-project configuration. To make it work, add: <code>-DCMAKE_TOOLCHAIN_FILE=&lt;vcpkg location&gt;/scripts/buildsystems/vcpkg.cmake</code>
    - To change build options (<code>option</code> in <code>CMakeLists.txt</code>), run cmake with <code>-D &lt;option name&gt;=&lt;option value&gt; &lt;build dir&gt;</code>. Example: <code>cmake -D BUILD_TESTING=OFF .</code></p>
<h2 id="building">Building<a class="headerlink" href="#building" title="Permanent link">&para;</a></h2>
<p>For building, use:</p>
<pre><code class="language-bash">cmake --build &lt;build dir&gt;
</code></pre>
<p>where build dir is the directory containing the build scripts (<code>CmakeFiles</code> folder).</p>
<p>To list the build options:</p>
<pre><code>cmake -L
</code></pre>
<h3 id="specify-the-build-type-debug-release">Specify the build type (Debug, Release)<a class="headerlink" href="#specify-the-build-type-debug-release" title="Permanent link">&para;</a></h3>
<p>To build in release mode, or any other build mode except for the default, we need to specify the parameters for CMake. Unfortunately, these parameters depends on the build system:</p>
<ul>
<li><strong>Single-configuration systems</strong> (Unix, MinGW) </li>
<li><strong>Multi-configuration systems</strong> (Visual Studio)</li>
</ul>
<h4 id="single-configuration-systems">Single-configuration systems<a class="headerlink" href="#single-configuration-systems" title="Permanent link">&para;</a></h4>
<p>Single configuration systems have the build type hardcoded in the build scripts. Therefore, we need to specify the build type for CMake when we generate the build scripts:</p>
<pre><code class="language-bash">cmake ../ -DCMAKE_BUILD_TYPE=Release
</code></pre>
<p><strong>By default, the build type is <code>Release</code></strong>.</p>
<h4 id="multi-configuration-systems">Multi-configuration systems<a class="headerlink" href="#multi-configuration-systems" title="Permanent link">&para;</a></h4>
<p>In multi-configuration systems, the <code>-DCMAKE_BUILD_TYPE</code> parameter is ignored, because the build configuration is supposed to be determined when building the code (i.e., same build scripts for debug and for release). Therefore, we omit it, and instead specify the <code>--config</code> parameter when building the code:</p>
<pre><code class="language-bash">cmake --build . --config Release
</code></pre>
<h3 id="specify-the-target">Specify the target<a class="headerlink" href="#specify-the-target" title="Permanent link">&para;</a></h3>
<p>We can use the <code>--target</code> parameter for that:</p>
<pre><code class="language-cmake">cmake --build . --target &lt;TARGET NAME&gt;
</code></pre>
<h2 id="clean-the-source-files">Clean the source files<a class="headerlink" href="#clean-the-source-files" title="Permanent link">&para;</a></h2>
<p>Run:</p>
<pre><code>cmake --build . --target clean
</code></pre>
<h1 id="handling-case-insensitivity">Handling Case Insensitivity<a class="headerlink" href="#handling-case-insensitivity" title="Permanent link">&para;</a></h1>
<p>Windows builds are, in line with the OS, case insensitive. Moreover, the Visual Studio does some magic with names internally, so the build is case insensitive even on VS WSL builds.</p>
<p>The case insensitivity can bring inconsistencies that later breake Unix builds. Therefore, it is desirable to have the build case sensitive even on Windows. Fortunatelly, we can toggle the case sensitivity at the OS level using this PowerShell command:</p>
<pre><code class="language-PowerShell">Get-ChildItem &lt;PROJECT ROOT PATH&gt; -Recurse -Directory | ForEach-Object { fsutil.exe file setCaseSensitiveInfo $_.FullName enable }
</code></pre>
<p>Note that this can break the git commits, so it is necessary to also configure git in your case-sensitive repo:</p>
<pre><code>git config core.ignorecase false
</code></pre></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../../js/base.js" defer></script>
        <script src="../../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
